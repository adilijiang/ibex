(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     78103,       2407]
NotebookOptionsPosition[     72915,       2220]
NotebookOutlinePosition[     73275,       2236]
CellTagsIndexPosition[     73232,       2233]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Tests", "Title",
 CellChangeTimes->{{3.6947981806919193`*^9, 3.69479818137024*^9}}],

Cell[CellGroupData[{

Cell["Utilities", "Chapter",
 CellChangeTimes->{{3.6947981834506197`*^9, 3.694798184409752*^9}}],

Cell[CellGroupData[{

Cell["Integration", "Section",
 CellChangeTimes->{{3.694798192835228*^9, 3.694798194273697*^9}, {
  3.694798241860347*^9, 3.694798242882571*^9}}],

Cell[CellGroupData[{

Cell["Cartesian 1D", "Subsection",
 CellChangeTimes->{{3.694879689867186*^9, 3.6948796921747427`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"func", "[", "x_", "]"}], ":=", "1"}], "\[IndentingNewLine]", 
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{"func", "[", "x", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "x1", ",", "x2"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.694798251811123*^9, 3.694798277450832*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "x1"}], "+", "x2"}]], "Output",
 CellChangeTimes->{{3.694798261702998*^9, 3.694798278258273*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"func", "[", "x_", "]"}], ":=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", "i", "]"}], 
       SuperscriptBox["x", "i"]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "4"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"func", "[", "x", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "x1", ",", "x2"}], "}"}]}], "]"}], "//", 
    "FullSimplify"}]}]}]], "Input",
 CellChangeTimes->{{3.6947982623286667`*^9, 3.6947982946099043`*^9}, {
  3.694798345425815*^9, 3.694798372807067*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "60"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "60"}], " ", "x1", " ", 
     RowBox[{"a", "[", "0", "]"}]}], "-", 
    RowBox[{"30", " ", 
     SuperscriptBox["x1", "2"], " ", 
     RowBox[{"a", "[", "1", "]"}]}], "-", 
    RowBox[{"20", " ", 
     SuperscriptBox["x1", "3"], " ", 
     RowBox[{"a", "[", "2", "]"}]}], "-", 
    RowBox[{"15", " ", 
     SuperscriptBox["x1", "4"], " ", 
     RowBox[{"a", "[", "3", "]"}]}], "+", 
    RowBox[{"5", " ", "x2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"12", " ", 
        RowBox[{"a", "[", "0", "]"}]}], "+", 
       RowBox[{"x2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"6", " ", 
           RowBox[{"a", "[", "1", "]"}]}], "+", 
          RowBox[{"4", " ", "x2", " ", 
           RowBox[{"a", "[", "2", "]"}]}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["x2", "2"], " ", 
           RowBox[{"a", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}], "-", 
    RowBox[{"12", " ", 
     SuperscriptBox["x1", "5"], " ", 
     RowBox[{"a", "[", "4", "]"}]}], "+", 
    RowBox[{"12", " ", 
     SuperscriptBox["x2", "5"], " ", 
     RowBox[{"a", "[", "4", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.694798358837596*^9, 3.6947983732194242`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cartesian 2D", "Subsection",
 CellChangeTimes->{{3.6948796966595297`*^9, 3.694879698416416*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"func", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", "1"}], "\[IndentingNewLine]", 
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{"func", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "x1", ",", "x2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", "y1", ",", "y2"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.69479894922552*^9, 3.694798972476654*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "x1"}], "+", "x2"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "y1"}], "+", "y2"}], ")"}]}]], "Output",
 CellChangeTimes->{3.694879704712028*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"func", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"a", "[", "0", "]"}], "+", 
   RowBox[{
    RowBox[{"a", "[", "1", "]"}], "x"}], "+", 
   RowBox[{
    RowBox[{"a", "[", "2", "]"}], "y"}], "+", 
   RowBox[{
    RowBox[{"a", "[", "3", "]"}], 
    SuperscriptBox["x", "2"]}], "+", 
   RowBox[{
    RowBox[{"a", "[", "4", "]"}], 
    SuperscriptBox["y", "2"]}], "+", 
   RowBox[{
    RowBox[{"a", "[", "5", "]"}], "x", " ", 
    "y"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{"x", ",", "y"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "x1", ",", "x2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", "y1", ",", "y2"}], "}"}]}], "]"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.694798984468296*^9, 3.6947990091233273`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "12"], " ", 
  RowBox[{"(", 
   RowBox[{"x1", "-", "x2"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"y1", "-", "y2"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"12", " ", 
     RowBox[{"a", "[", "0", "]"}]}], "+", 
    RowBox[{"6", " ", 
     RowBox[{"(", 
      RowBox[{"x1", "+", "x2"}], ")"}], " ", 
     RowBox[{"a", "[", "1", "]"}]}], "+", 
    RowBox[{"6", " ", 
     RowBox[{"(", 
      RowBox[{"y1", "+", "y2"}], ")"}], " ", 
     RowBox[{"a", "[", "2", "]"}]}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["x1", "2"], "+", 
       RowBox[{"x1", " ", "x2"}], "+", 
       SuperscriptBox["x2", "2"]}], ")"}], " ", 
     RowBox[{"a", "[", "3", "]"}]}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["y1", "2"], "+", 
       RowBox[{"y1", " ", "y2"}], "+", 
       SuperscriptBox["y2", "2"]}], ")"}], " ", 
     RowBox[{"a", "[", "4", "]"}]}], "+", 
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{"x1", "+", "x2"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"y1", "+", "y2"}], ")"}], " ", 
     RowBox[{"a", "[", "5", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.694799005346941*^9, 3.6947990100672617`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cylindrical 2D", "Subsection",
 CellChangeTimes->{{3.694879710518652*^9, 3.694879712736754*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"func", "[", "r_", "]"}], ":=", "1"}], "\[IndentingNewLine]", 
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{"r", " ", 
    RowBox[{"func", "[", "r", "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"r", ",", "0", ",", "r1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", 
     RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.694799013271722*^9, 3.6947990469618053`*^9}}],

Cell[BoxData[
 RowBox[{"\[Pi]", " ", 
  SuperscriptBox["r1", "2"]}]], "Output",
 CellChangeTimes->{3.694799047462179*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"func", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"a", "[", "0", "]"}], "+", 
   RowBox[{
    RowBox[{"a", "[", "1", "]"}], "x"}], "+", 
   RowBox[{
    RowBox[{"a", "[", "2", "]"}], "y"}], "+", 
   RowBox[{
    RowBox[{"a", "[", "3", "]"}], 
    SuperscriptBox["x", "2"]}], "+", 
   RowBox[{
    RowBox[{"a", "[", "4", "]"}], 
    SuperscriptBox["y", "2"]}], "+", 
   RowBox[{
    RowBox[{"a", "[", "5", "]"}], "x", " ", 
    "y"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"r", " ", 
     RowBox[{"func", "[", 
      RowBox[{
       RowBox[{"x0", "+", 
        RowBox[{"r", " ", 
         RowBox[{"Cos", "[", "t", "]"}]}]}], ",", 
       RowBox[{"y0", "+", 
        RowBox[{"r", " ", 
         RowBox[{"Sin", "[", "t", "]"}]}]}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "0", ",", "r1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", 
      RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.694799062017502*^9, 3.69479911570216*^9}, {
  3.694799201761323*^9, 3.694799212206683*^9}, {3.6948801194953127`*^9, 
  3.6948801253247004`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", "\[Pi]", " ", 
  SuperscriptBox["r1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"4", " ", 
     RowBox[{"a", "[", "0", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["r1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "[", "3", "]"}], "+", 
       RowBox[{"a", "[", "4", "]"}]}], ")"}]}], "+", 
    RowBox[{"4", " ", "y0", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "[", "2", "]"}], "+", 
       RowBox[{"y0", " ", 
        RowBox[{"a", "[", "4", "]"}]}]}], ")"}]}], "+", 
    RowBox[{"4", " ", "x0", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "[", "1", "]"}], "+", 
       RowBox[{"x0", " ", 
        RowBox[{"a", "[", "3", "]"}]}], "+", 
       RowBox[{"y0", " ", 
        RowBox[{"a", "[", "5", "]"}]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.694799116668128*^9, 3.6947991380251303`*^9}, {
   3.694799192297558*^9, 3.694799212977323*^9}, 3.6948801268856697`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cartesian 3D", "Subsection",
 CellChangeTimes->{{3.694879720245954*^9, 3.6948797229212418`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"func", "[", 
   RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
  "1"}], "\[IndentingNewLine]", 
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{"func", "[", 
    RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "x1", ",", "x2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", "y1", ",", "y2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", "z1", ",", "z2"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.69487972604573*^9, 3.694879763785673*^9}, {
  3.6948798291602907`*^9, 3.694879829418867*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "x1"}], "+", "x2"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "y1"}], "+", "y2"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "z1"}], "+", "z2"}], ")"}]}]], "Output",
 CellChangeTimes->{3.694879764214714*^9, 3.694879829740855*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"func", "[", 
   RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"a", "[", "0", "]"}], "+", 
   RowBox[{
    RowBox[{"a", "[", "1", "]"}], "x"}], "+", 
   RowBox[{
    RowBox[{"a", "[", "2", "]"}], "y"}], "+", 
   RowBox[{
    RowBox[{"a", "[", "3", "]"}], 
    SuperscriptBox["x", "2"]}], "+", 
   RowBox[{
    RowBox[{"a", "[", "4", "]"}], 
    SuperscriptBox["y", "2"]}], "+", 
   RowBox[{
    RowBox[{"a", "[", "5", "]"}], 
    SuperscriptBox["z", "2"]}], "+", 
   RowBox[{
    RowBox[{"a", "[", "6", "]"}], "x", " ", "y"}], "+", 
   RowBox[{
    RowBox[{"a", "[", "7", "]"}], "y", " ", "z"}], " ", "+", 
   RowBox[{
    RowBox[{"a", "[", "8", "]"}], "x", " ", 
    "z"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "x1", ",", "x2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", "y1", ",", "y2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"z", ",", "z1", ",", "z2"}], "}"}]}], "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6948797660134974`*^9, 3.6948798384260187`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "12"]}], " ", 
  RowBox[{"(", 
   RowBox[{"x1", "-", "x2"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"y1", "-", "y2"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"z1", "-", "z2"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"12", " ", 
     RowBox[{"a", "[", "0", "]"}]}], "+", 
    RowBox[{"6", " ", 
     RowBox[{"(", 
      RowBox[{"y1", "+", "y2"}], ")"}], " ", 
     RowBox[{"a", "[", "2", "]"}]}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["x1", "2"], " ", 
     RowBox[{"a", "[", "3", "]"}]}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["x2", "2"], " ", 
     RowBox[{"a", "[", "3", "]"}]}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["y1", "2"], "+", 
       RowBox[{"y1", " ", "y2"}], "+", 
       SuperscriptBox["y2", "2"]}], ")"}], " ", 
     RowBox[{"a", "[", "4", "]"}]}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["z1", "2"], "+", 
       RowBox[{"z1", " ", "z2"}], "+", 
       SuperscriptBox["z2", "2"]}], ")"}], " ", 
     RowBox[{"a", "[", "5", "]"}]}], "+", 
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{"y1", "+", "y2"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"z1", "+", "z2"}], ")"}], " ", 
     RowBox[{"a", "[", "7", "]"}]}], "+", 
    RowBox[{"3", " ", "x2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"a", "[", "1", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"y1", "+", "y2"}], ")"}], " ", 
        RowBox[{"a", "[", "6", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"z1", "+", "z2"}], ")"}], " ", 
        RowBox[{"a", "[", "8", "]"}]}]}], ")"}]}], "+", 
    RowBox[{"x1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"6", " ", 
        RowBox[{"a", "[", "1", "]"}]}], "+", 
       RowBox[{"4", " ", "x2", " ", 
        RowBox[{"a", "[", "3", "]"}]}], "+", 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{"y1", "+", "y2"}], ")"}], " ", 
        RowBox[{"a", "[", "6", "]"}]}], "+", 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{"z1", "+", "z2"}], ")"}], " ", 
        RowBox[{"a", "[", "8", "]"}]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.694879823237577*^9, 3.694879841328987*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Spherical 3D", "Subsection",
 CellChangeTimes->{{3.6948799641441402`*^9, 3.694879966170458*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"func", "[", "r_", "]"}], ":=", "1"}], "\[IndentingNewLine]", 
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox["r", "2"], 
    RowBox[{"Sin", "[", "g", "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"r", ",", "0", ",", "r1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", 
     RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"g", ",", "0", ",", "\[Pi]"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.694879968127277*^9, 3.6948800326343317`*^9}, {
  3.694880184172324*^9, 3.694880209770412*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"4", " ", "\[Pi]", " ", 
   SuperscriptBox["r1", "3"]}], "3"]], "Output",
 CellChangeTimes->{{3.694880008301385*^9, 3.69488001326014*^9}, 
   3.694880231910513*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"func", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"a", "[", "0", "]"}], "+", 
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], "x"}], "+", 
    RowBox[{
     RowBox[{"a", "[", "2", "]"}], "y"}], "+", 
    RowBox[{
     RowBox[{"a", "[", "3", "]"}], 
     SuperscriptBox["x", "2"]}], "+", 
    RowBox[{
     RowBox[{"a", "[", "4", "]"}], 
     SuperscriptBox["y", "2"]}], "+", 
    RowBox[{
     RowBox[{"a", "[", "5", "]"}], 
     SuperscriptBox["z", "2"]}], "+", 
    RowBox[{
     RowBox[{"a", "[", "6", "]"}], "x", " ", "y"}], "+", 
    RowBox[{
     RowBox[{"a", "[", "7", "]"}], "y", " ", "z"}], "+", 
    RowBox[{
     RowBox[{"a", "[", "8", "]"}], "x", " ", "z"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"func", "[", 
      RowBox[{
       RowBox[{"x0", "+", 
        RowBox[{"r", " ", 
         RowBox[{"Cos", "[", "t", "]"}], 
         RowBox[{"Sin", "[", "g", "]"}]}]}], ",", 
       RowBox[{"y0", "+", 
        RowBox[{"r", " ", 
         RowBox[{"Sin", "[", "t", "]"}], 
         RowBox[{"Sin", "[", "g", "]"}]}]}], ",", 
       RowBox[{"z0", "+", 
        RowBox[{"r", " ", 
         RowBox[{"Cos", "[", "g", "]"}]}]}]}], "]"}], 
     SuperscriptBox["r", "2"], 
     RowBox[{"Sin", "[", "g", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "0", ",", "r1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", 
      RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"g", ",", "0", ",", "\[Pi]"}], "}"}]}], "]"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.6948801696176977`*^9, 3.69488020176392*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["4", "3"], " ", "\[Pi]", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     FractionBox["1", "5"], " ", 
     SuperscriptBox["r1", "5"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "[", "3", "]"}], "+", 
       RowBox[{"a", "[", "4", "]"}], "+", 
       RowBox[{"a", "[", "5", "]"}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["r1", "3"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "[", "0", "]"}], "+", 
       RowBox[{
        SuperscriptBox["x0", "2"], " ", 
        RowBox[{"a", "[", "3", "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["z0", "2"], " ", 
        RowBox[{"a", "[", "5", "]"}]}], "+", 
       RowBox[{"y0", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "[", "2", "]"}], "+", 
          RowBox[{"y0", " ", 
           RowBox[{"a", "[", "4", "]"}]}], "+", 
          RowBox[{"z0", " ", 
           RowBox[{"a", "[", "7", "]"}]}]}], ")"}]}], "+", 
       RowBox[{"x0", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "[", "1", "]"}], "+", 
          RowBox[{"y0", " ", 
           RowBox[{"a", "[", "6", "]"}]}], "+", 
          RowBox[{"z0", " ", 
           RowBox[{"a", "[", "8", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.694880231657875*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Spatial discretization", "Chapter",
 CellChangeTimes->{{3.6948816306673403`*^9, 3.694881633080002*^9}}],

Cell[CellGroupData[{

Cell["RBF", "Section",
 CellChangeTimes->{{3.694881640954659*^9, 3.694881641250716*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"gauss", "[", 
    RowBox[{"r_", ",", "nd_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        SuperscriptBox["s", "2"]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", "nd"}], "}"}]}], "]"}], "/.", 
    RowBox[{"s", "\[Rule]", "r"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"multi", "[", 
    RowBox[{"r_", ",", "nd_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      SqrtBox[
       RowBox[{"1", "+", 
        SuperscriptBox["s", "2"]}]], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", "nd"}], "}"}]}], "]"}], "/.", 
    RowBox[{"s", "\[Rule]", "r"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"inv", "[", 
    RowBox[{"r_", ",", "nd_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      FractionBox["1", 
       SqrtBox[
        RowBox[{"1", "+", 
         SuperscriptBox["s", "2"]}]]], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", "nd"}], "}"}]}], "]"}], "/.", 
    RowBox[{"s", "\[Rule]", "r"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"wend", "[", 
    RowBox[{"r_", ",", "nd_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"Piecewise", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"1", "-", "s"}], ")"}], "2"], ",", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"1", "-", "s"}], ")"}], "4"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"4", "s"}], "+", "1"}], ")"}]}], ",", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"1", "-", "s"}], ")"}], "6"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"35", 
                  SuperscriptBox["s", "2"]}], "+", 
                 RowBox[{"18", "s"}], "+", "3"}], ")"}]}], ",", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"1", "-", "s"}], ")"}], "8"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"32", 
                  SuperscriptBox["s", "3"]}], "+", 
                 RowBox[{"25", 
                  SuperscriptBox["s", "2"]}], "+", 
                 RowBox[{"8", "s"}], "+", "1"}], ")"}]}]}], "}"}], "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "nd"}], "}"}]}], "]"}], "/.", 
         RowBox[{"s", "\[Rule]", 
          RowBox[{"Abs", "[", "r", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"Abs", "[", "r", "]"}], "\[LessEqual]", "1"}]}], "}"}], ",", 
      
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"Abs", "[", "r", "]"}], ">", "1"}]}], "}"}]}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compgauss", "[", 
   RowBox[{"r_", ",", "rad_", ",", "nd_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"r", "<", "rad"}], ",", 
     RowBox[{"D", "[", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "s"}], "*", "s"}], "]"}], "-", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "rad"}], "*", "rad"}], "]"}]}], 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "rad"}], "*", "rad"}], "]"}]}]], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "nd"}], "}"}]}], "]"}], ",", "0"}], "]"}], "/.", 
   RowBox[{"s", "\[Rule]", "r"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trungauss", "[", 
   RowBox[{"r_", ",", "rad_", ",", "nd_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"r", "<", "rad"}], ",", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"-", 
         SuperscriptBox["s", "2"]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "nd"}], "}"}]}], "]"}], ",", "0"}], "]"}], "/.", 
   RowBox[{"s", "\[Rule]", "r"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"points", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"1", "/", "2"}], ",", "1"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6948817448504868`*^9, 3.694881753913973*^9}, {
  3.694881810955504*^9, 3.694881823010363*^9}, {3.694881859909214*^9, 
  3.69488186373186*^9}, {3.694881912054875*^9, 3.694881965582423*^9}, {
  3.694882043923864*^9, 3.6948820500214767`*^9}, {3.69488237869142*^9, 
  3.694882391014368*^9}, {3.694882455434437*^9, 3.694882479838578*^9}, {
  3.694882541551985*^9, 3.6948825427571707`*^9}, {3.695591266642454*^9, 
  3.6955912848340597`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"gauss", "[", 
     RowBox[{"points", ",", "nd"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"nd", ",", "0", ",", "2"}], "}"}]}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"multi", "[", 
     RowBox[{"points", ",", "nd"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"nd", ",", "0", ",", "2"}], "}"}]}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"inv", "[", 
     RowBox[{"points", ",", "nd"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"nd", ",", "0", ",", "2"}], "}"}]}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"wend", "[", 
       RowBox[{
        RowBox[{"points", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", "nd", ",", "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "points", "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"nd", ",", "0", ",", "2"}], "}"}]}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"wend", "[", 
       RowBox[{
        RowBox[{"points", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", "nd", ",", "1"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "points", "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"nd", ",", "0", ",", "2"}], "}"}]}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"wend", "[", 
       RowBox[{
        RowBox[{"points", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", "nd", ",", "2"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "points", "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"nd", ",", "0", ",", "2"}], "}"}]}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"wend", "[", 
       RowBox[{
        RowBox[{"points", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", "nd", ",", "3"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "points", "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"nd", ",", "0", ",", "2"}], "}"}]}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"compgauss", "[", 
       RowBox[{
        RowBox[{"points", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", "2", ",", "nd"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "points", "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"nd", ",", "0", ",", "2"}], "}"}]}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"trungauss", "[", 
       RowBox[{
        RowBox[{"points", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        FractionBox["7", "10"], ",", "nd"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "points", "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"nd", ",", "0", ",", "2"}], "}"}]}], "]"}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.694881995176361*^9, 3.694882019401787*^9}, {
  3.694882439373353*^9, 3.694882450431036*^9}, {3.6948824913907623`*^9, 
  3.694882555820503*^9}, {3.695591310491748*^9, 3.69559133876108*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["1", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"1", "/", "4"}]]], ",", 
     FractionBox["1", "\[ExponentialE]"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox["1", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"1", "/", "4"}]]]}], ",", 
     RowBox[{"-", 
      FractionBox["2", "\[ExponentialE]"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2"}], ",", 
     RowBox[{"-", 
      FractionBox["1", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"1", "/", "4"}]]]}], ",", 
     FractionBox["2", "\[ExponentialE]"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.694881756178121*^9, {3.6948820207808447`*^9, 3.694882057271577*^9}, 
   3.694882451004958*^9, {3.694882483108116*^9, 3.694882556223515*^9}, 
   3.6955912967205067`*^9, 3.6955913396844378`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox[
      SqrtBox["5"], "2"], ",", 
     SqrtBox["2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["1", 
      SqrtBox["5"]], ",", 
     FractionBox["1", 
      SqrtBox["2"]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["8", 
      RowBox[{"5", " ", 
       SqrtBox["5"]}]], ",", 
     FractionBox["1", 
      RowBox[{"2", " ", 
       SqrtBox["2"]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.694881756178121*^9, {3.6948820207808447`*^9, 3.694882057271577*^9}, 
   3.694882451004958*^9, {3.694882483108116*^9, 3.694882556223515*^9}, 
   3.6955912967205067`*^9, 3.695591339697955*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["2", 
      SqrtBox["5"]], ",", 
     FractionBox["1", 
      SqrtBox["2"]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox["4", 
       RowBox[{"5", " ", 
        SqrtBox["5"]}]]}], ",", 
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", 
      FractionBox["16", 
       RowBox[{"25", " ", 
        SqrtBox["5"]}]]}], ",", 
     FractionBox["1", 
      RowBox[{"4", " ", 
       SqrtBox["2"]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.694881756178121*^9, {3.6948820207808447`*^9, 3.694882057271577*^9}, 
   3.694882451004958*^9, {3.694882483108116*^9, 3.694882556223515*^9}, 
   3.6955912967205067`*^9, 3.695591339707677*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["1", "4"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2"}], ",", 
     RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.694881756178121*^9, {3.6948820207808447`*^9, 3.694882057271577*^9}, 
   3.694882451004958*^9, {3.694882483108116*^9, 3.694882556223515*^9}, 
   3.6955912967205067`*^9, 3.6955913397173033`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["3", "16"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox["5", "4"]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "20"}], ",", "5", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.694881756178121*^9, {3.6948820207808447`*^9, 3.694882057271577*^9}, 
   3.694882451004958*^9, {3.694882483108116*^9, 3.694882556223515*^9}, 
   3.6955912967205067`*^9, 3.695591339726879*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", 
     FractionBox["83", "256"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox["49", "16"]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "56"}], ",", 
     FractionBox["161", "8"], ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.694881756178121*^9, {3.6948820207808447`*^9, 3.694882057271577*^9}, 
   3.694882451004958*^9, {3.694882483108116*^9, 3.694882556223515*^9}, 
   3.6955912967205067`*^9, 3.695591339736521*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["61", "1024"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox["187", "256"]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "22"}], ",", 
     FractionBox["869", "128"], ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.694881756178121*^9, {3.6948820207808447`*^9, 3.694882057271577*^9}, 
   3.694882451004958*^9, {3.694882483108116*^9, 3.694882556223515*^9}, 
   3.6955912967205067`*^9, 3.695591339746119*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"15", "/", "4"}]]}], 
       RowBox[{"1", "-", 
        SuperscriptBox["\[ExponentialE]", "4"]}]]}], ",", 
     FractionBox[
      RowBox[{"1", "+", "\[ExponentialE]", "+", 
       SuperscriptBox["\[ExponentialE]", "2"]}], 
      RowBox[{"1", "+", "\[ExponentialE]", "+", 
       SuperscriptBox["\[ExponentialE]", "2"], "+", 
       SuperscriptBox["\[ExponentialE]", "3"]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox[
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"15", "/", "4"}]], 
      RowBox[{"1", "-", 
       SuperscriptBox["\[ExponentialE]", "4"]}]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["\[ExponentialE]", "3"]}], 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", "4"]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["\[ExponentialE]", "4"]}], 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", "4"]}]]}], ",", 
     FractionBox[
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"15", "/", "4"}]], 
      RowBox[{"1", "-", 
       SuperscriptBox["\[ExponentialE]", "4"]}]], ",", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", "3"]}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["\[ExponentialE]", "4"]}]]}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{
  3.694881756178121*^9, {3.6948820207808447`*^9, 3.694882057271577*^9}, 
   3.694882451004958*^9, {3.694882483108116*^9, 3.694882556223515*^9}, 
   3.6955912967205067`*^9, 3.69559133975609*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["1", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"1", "/", "4"}]]], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox["1", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"1", "/", "4"}]]]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2"}], ",", 
     RowBox[{"-", 
      FractionBox["1", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"1", "/", "4"}]]]}], ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.694881756178121*^9, {3.6948820207808447`*^9, 3.694882057271577*^9}, 
   3.694882451004958*^9, {3.694882483108116*^9, 3.694882556223515*^9}, 
   3.6955912967205067`*^9, 3.69559133976576*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Weight function", "Section",
 CellChangeTimes->{{3.6955905714273977`*^9, 3.695590572835988*^9}}],

Cell[CellGroupData[{

Cell["General functions", "Subsection",
 CellChangeTimes->{{3.6957505257853527`*^9, 3.6957505419163227`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rbf", "[", 
   RowBox[{"r_", ",", "rad_", ",", "nd_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"r", "<", "rad"}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"D", "[", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "s"}], "*", "s"}], "]"}], "-", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "rad"}], "*", "rad"}], "]"}]}], 
         RowBox[{"1", "-", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "rad"}], "*", "rad"}], "]"}]}]], ",", 
        RowBox[{"{", 
         RowBox[{"s", ",", "nd"}], "}"}]}], "]"}], "]"}], ",", "0"}], "]"}], "/.", 
   RowBox[{"s", "\[Rule]", "r"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dist", "[", 
   RowBox[{"x_", ",", "y_", ",", "x0_", ",", "y0_", ",", "xd_", ",", "yd_"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"xv", "-", "x0"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"yv", "-", "y0"}], ")"}], "2"]}]], ",", 
      RowBox[{"{", 
       RowBox[{"xv", ",", "xd"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"yv", ",", "yd"}], "}"}]}], "]"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xv", "\[Rule]", "x"}], ",", 
     RowBox[{"yv", "\[Rule]", "y"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"basis", "[", 
   RowBox[{"x_", ",", "y_", ",", "x0_", ",", "y0_", ",", "rad_"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"shape", ",", "d"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"shape", "=", 
      RowBox[{"5.", "/", "rad"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"dist", "[", 
       RowBox[{"x", ",", "y", ",", "x0", ",", "y0", ",", "0", ",", "0"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rbf", "[", 
      RowBox[{
       RowBox[{"shape", "*", "d"}], ",", "5.", ",", "0"}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dbasis", "[", 
   RowBox[{"x_", ",", "y_", ",", "x0_", ",", "y0_", ",", "rad_", ",", "nd_"}],
    "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"shape", ",", "d", ",", "dd"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"shape", "=", 
      RowBox[{"5.", "/", "rad"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"dist", "[", 
       RowBox[{"x", ",", "y", ",", "x0", ",", "y0", ",", "0", ",", "0"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dd", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nd", "\[Equal]", "1"}], ",", 
        RowBox[{"dist", "[", 
         RowBox[{"x", ",", "y", ",", "x0", ",", "y0", ",", "1", ",", "0"}], 
         "]"}], ",", 
        RowBox[{"dist", "[", 
         RowBox[{"x", ",", "y", ",", "x0", ",", "y0", ",", "0", ",", "1"}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rbf", "[", 
       RowBox[{
        RowBox[{"shape", "*", "d"}], ",", "5.", ",", "1"}], "]"}], "*", 
      "shape", "*", "dd"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getBasis", "[", 
   RowBox[{"x_", ",", "y_", ",", "x0_", ",", "y0_", ",", "rad_"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"basis", "[", 
     RowBox[{"x", ",", "y", ",", "x0", ",", "y0", ",", "rad"}], "]"}], ",", 
    RowBox[{"dbasis", "[", 
     RowBox[{"x", ",", "y", ",", "x0", ",", "y0", ",", "rad", ",", "1"}], 
     "]"}], ",", 
    RowBox[{"dbasis", "[", 
     RowBox[{"x", ",", "y", ",", "x0", ",", "y0", ",", "rad", ",", "2"}], 
     "]"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.6955906503941174`*^9, 3.695590684020286*^9}, {
  3.695590729141786*^9, 3.69559081574533*^9}, {3.695590890076643*^9, 
  3.695590900873101*^9}, {3.695590938385613*^9, 3.695590943189098*^9}, {
  3.695591005226323*^9, 3.695591086784985*^9}, {3.6955911264551373`*^9, 
  3.695591148506466*^9}, {3.695591208800939*^9, 3.695591235517365*^9}, {
  3.6955914303540983`*^9, 3.695591551985138*^9}, {3.695591729843899*^9, 
  3.695591906501998*^9}, {3.6955929357371902`*^9, 3.69559295709233*^9}, {
  3.695593111949669*^9, 3.695593144270246*^9}, {3.6955933578224173`*^9, 
  3.6955933671480923`*^9}, {3.695594132504467*^9, 3.695594176967827*^9}, {
  3.695594290189687*^9, 3.695594298647635*^9}, {3.695594336706533*^9, 
  3.6955943631761913`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Get specific functions and limits of integration", "Subsection",
 CellChangeTimes->{{3.695592789454405*^9, 3.695592790021399*^9}, {
  3.6957505437323017`*^9, 3.695750558387877*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"numWeight", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"numBasis", "=", "5"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"w", "[", "1", "]"}], "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"getBasis", "[", 
     RowBox[{"x", ",", "y", ",", "0.5", ",", "0.5", ",", "0.3"}], "]"}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"b", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"getBasis", "[", 
     RowBox[{"x", ",", "y", ",", "0.6", ",", "0.6", ",", "0.1"}], "]"}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"b", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"getBasis", "[", 
     RowBox[{"x", ",", "y", ",", "0.45", ",", "0.55", ",", "0.4"}], "]"}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"b", "[", 
     RowBox[{"3", ",", "1"}], "]"}], "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"getBasis", "[", 
     RowBox[{"x", ",", "y", ",", "0.35", ",", "0.3", ",", "0.1"}], "]"}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"b", "[", 
     RowBox[{"4", ",", "1"}], "]"}], "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"getBasis", "[", 
     RowBox[{"x", ",", "y", ",", "0.2", ",", "0.7", ",", "0.1"}], "]"}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"b", "[", 
     RowBox[{"5", ",", "1"}], "]"}], "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"getBasis", "[", 
     RowBox[{"x", ",", "y", ",", "0.7", ",", "0.2", ",", "0.55"}], "]"}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"w", "[", "2", "]"}], "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"getBasis", "[", 
     RowBox[{"x", ",", "y", ",", "0.", ",", "0.", ",", "0.4"}], "]"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"b", "[", 
     RowBox[{"1", ",", "2"}], "]"}], "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"getBasis", "[", 
     RowBox[{"x", ",", "y", ",", "0.25", ",", "0.3", ",", "0.5"}], "]"}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"b", "[", 
     RowBox[{"2", ",", "2"}], "]"}], "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"getBasis", "[", 
     RowBox[{"x", ",", "y", ",", "0.2", ",", "0.5", ",", "0.3"}], "]"}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"b", "[", 
     RowBox[{"3", ",", "2"}], "]"}], "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"getBasis", "[", 
     RowBox[{"x", ",", "y", ",", "0.3", ",", "0.2", ",", "0.1"}], "]"}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"b", "[", 
     RowBox[{"4", ",", "2"}], "]"}], "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"getBasis", "[", 
     RowBox[{"x", ",", "y", ",", "0.4", ",", "0.", ",", "0.15"}], "]"}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"b", "[", 
     RowBox[{"5", ",", "2"}], "]"}], "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"getBasis", "[", 
     RowBox[{"x", ",", "y", ",", "0.1", ",", "0.15", ",", "0.05"}], "]"}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"w", "[", "3", "]"}], "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"getBasis", "[", 
     RowBox[{"x", ",", "y", ",", "0.9", ",", "0.5", ",", "0.4"}], "]"}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"b", "[", 
     RowBox[{"1", ",", "3"}], "]"}], "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"getBasis", "[", 
     RowBox[{"x", ",", "y", ",", "0.9", ",", "0.9", ",", "0.2"}], "]"}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"b", "[", 
     RowBox[{"2", ",", "3"}], "]"}], "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"getBasis", "[", 
     RowBox[{"x", ",", "y", ",", "1.", ",", "0.4", ",", "0.25"}], "]"}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"b", "[", 
     RowBox[{"3", ",", "3"}], "]"}], "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"getBasis", "[", 
     RowBox[{"x", ",", "y", ",", "0.7", ",", "0.2", ",", "0.15"}], "]"}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"b", "[", 
     RowBox[{"4", ",", "3"}], "]"}], "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"getBasis", "[", 
     RowBox[{"x", ",", "y", ",", "0.8", ",", "0.", ",", "0.2"}], "]"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"b", "[", 
      RowBox[{"5", ",", "3"}], "]"}], "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "=", 
    RowBox[{
     RowBox[{"getBasis", "[", 
      RowBox[{"x", ",", "y", ",", "0.2", ",", "0.6", ",", "0.4"}], "]"}], "//",
      "Simplify"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"bw", "[", 
       RowBox[{"i", ",", "j"}], "]"}], "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"TensorProduct", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"w", "[", "j", "]"}], "[", 
         RowBox[{"x", ",", "y"}], "]"}], ",", 
        RowBox[{
         RowBox[{"b", "[", 
          RowBox[{"i", ",", "j"}], "]"}], "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "]"}], "//", "Simplify"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "numBasis"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "numWeight"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xmin", "[", "1", "]"}], "=", 
   RowBox[{"0.5", "-", "0.3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xmax", "[", "1", "]"}], "=", 
   RowBox[{"0.5", "+", "0.3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ymin", "[", "1", "]"}], "=", 
   RowBox[{"0.5", "-", "0.3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ymax", "[", "1", "]"}], "=", 
   RowBox[{"0.5", "+", "0.3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xmin", "[", "2", "]"}], "=", "0."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xmax", "[", "2", "]"}], "=", "0.4"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ymin", "[", "2", "]"}], "=", "0."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ymax", "[", "2", "]"}], "=", "0.4"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xmin", "[", "3", "]"}], "=", 
   RowBox[{"0.9", "-", "0.4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xmax", "[", "3", "]"}], "=", "1.0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ymin", "[", "3", "]"}], "=", 
   RowBox[{"0.5", "-", "0.4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ymax", "[", "3", "]"}], "=", 
    RowBox[{"0.5", "+", "0.4"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"precision", "=", "15"}], ";"}]}], "Input",
 CellChangeTimes->{{3.695592050238676*^9, 3.695592072341165*^9}, {
   3.695592138015375*^9, 3.695592159361649*^9}, {3.695592470273687*^9, 
   3.695592478779722*^9}, {3.695592519329207*^9, 3.695592519474207*^9}, {
   3.69559266952172*^9, 3.6955926696383467`*^9}, {3.6955927274217863`*^9, 
   3.695592727666582*^9}, {3.695592773833906*^9, 3.6955927808356524`*^9}, {
   3.6955928247233877`*^9, 3.69559290577712*^9}, {3.6955930119681168`*^9, 
   3.695593027769869*^9}, {3.695593151615069*^9, 3.6955931972457542`*^9}, {
   3.6955932723685503`*^9, 3.695593289018248*^9}, {3.695593336607946*^9, 
   3.695593338478259*^9}, {3.695593398604035*^9, 3.695593462820939*^9}, {
   3.6955935094505873`*^9, 3.6955935296208572`*^9}, {3.695593662030692*^9, 
   3.695593970100803*^9}, {3.695594090697096*^9, 3.69559409354764*^9}, {
   3.6955941247896*^9, 3.695594128962694*^9}, {3.6955947569834967`*^9, 
   3.6955947887261133`*^9}, {3.6955948577874537`*^9, 3.69559487355548*^9}, 
   3.695595206024481*^9, {3.695596578809883*^9, 3.69559657900799*^9}, {
   3.6955966273206*^9, 3.695596632006373*^9}, {3.6956579575235147`*^9, 
   3.695657966461561*^9}, {3.695750454262878*^9, 3.695750468887735*^9}, {
   3.695750513979616*^9, 3.695750517429199*^9}, {3.695750599404173*^9, 
   3.695750625793521*^9}, {3.695750759826231*^9, 3.6957508499861317`*^9}, {
   3.695754766757169*^9, 3.6957548030186787`*^9}, {3.695759493764127*^9, 
   3.695759493976102*^9}, {3.695760366631662*^9, 3.695760366913547*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Perform volume integrals", "Subsection",
 CellChangeTimes->{{3.69575064677385*^9, 3.695750649205945*^9}, {
  3.695758626811531*^9, 3.695758627781951*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"intvW", "[", "j", "]"}], "=", 
    RowBox[{
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"w", "[", "j", "]"}], "[", 
        RowBox[{"x", ",", "y"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"xmin", "[", "j", "]"}], ",", 
         RowBox[{"xmax", "[", "j", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{"ymin", "[", "j", "]"}], ",", 
         RowBox[{"ymax", "[", "j", "]"}]}], "}"}], ",", 
       RowBox[{"WorkingPrecision", "\[Rule]", "precision"}]}], "]"}], "//", 
     "Quiet"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "numWeight"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.69559371977107*^9, 3.695593720747746*^9}, {
   3.695593998543923*^9, 3.695594006032659*^9}, {3.695594049785692*^9, 
   3.695594073422707*^9}, {3.695594965353467*^9, 3.6955949803108387`*^9}, {
   3.695595155040181*^9, 3.695595188497788*^9}, {3.695595234369128*^9, 
   3.695595266994985*^9}, {3.6955954395901957`*^9, 3.695595525225391*^9}, {
   3.695595561243923*^9, 3.695595561650806*^9}, {3.695595880425105*^9, 
   3.6955959163721743`*^9}, {3.695596297124558*^9, 3.695596311183271*^9}, {
   3.695596590913774*^9, 3.695596649736017*^9}, {3.695596758883244*^9, 
   3.695596775626278*^9}, {3.6956579757075233`*^9, 3.695657976021359*^9}, {
   3.69575027318849*^9, 3.6957502764412203`*^9}, {3.695750566920906*^9, 
   3.6957505960717382`*^9}, {3.695750634240635*^9, 3.69575064269613*^9}, 
   3.695758767547361*^9, {3.6957589146203547`*^9, 3.695758919955892*^9}, {
   3.695759086397122*^9, 3.695759115411932*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Do", "::", "itform"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Argument \[NoBreak]\\!\\(WorkingPrecision \[Rule] \
precision\\)\[NoBreak] at position \[NoBreak]\\!\\(3\\)\[NoBreak] does not \
have the correct form for an iterator. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/itform\\\", \
ButtonNote -> \\\"Do::itform\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.695759097743416*^9}],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"intvW", "[", "j", "]"}], "=", 
    RowBox[{"Quiet", "[", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"w", "[", "j", "]"}], "[", 
        RowBox[{"x", ",", "y"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"xmin", "[", "j", "]"}], ",", 
         RowBox[{"xmax", "[", "j", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{"ymin", "[", "j", "]"}], ",", 
         RowBox[{"ymax", "[", "j", "]"}]}], "}"}]}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "numWeight"}], "}"}], ",", 
   RowBox[{"WorkingPrecision", "\[Rule]", "precision"}]}], "]"}]], "Output",
 CellChangeTimes->{3.695759097754208*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"intvBW", "[", 
     RowBox[{"i", ",", "j"}], "]"}], "=", 
    RowBox[{
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"bw", "[", 
         RowBox[{"i", ",", "j"}], "]"}], "[", 
        RowBox[{"x", ",", "y"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"xmin", "[", "j", "]"}], ",", 
         RowBox[{"xmax", "[", "j", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{"ymin", "[", "j", "]"}], ",", 
         RowBox[{"ymax", "[", "j", "]"}]}], "}"}], ",", 
       RowBox[{"WorkingPrecision", "\[Rule]", "precision"}]}], "]"}], "//", 
     "Quiet"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "numBasis"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "numWeight"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.695596738843505*^9, 3.695596771863092*^9}, 
   3.695598359884532*^9, {3.695750279951858*^9, 3.695750281971726*^9}, {
   3.695750652275009*^9, 3.695750725880619*^9}, {3.695750944653688*^9, 
   3.6957509644707537`*^9}, 3.695758770818507*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Format volume integrals", "Subsection",
 CellChangeTimes->{{3.6957503359727707`*^9, 3.69575033838181*^9}, {
  3.695758630766246*^9, 3.69575863276574*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ivW", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"intvW", "[", "j", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "numWeight"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ivDW", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"intvW", "[", "j", "]"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", "3"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "numWeight"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ivBW", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"intvBW", "[", 
         RowBox[{"i", ",", "j"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "numBasis"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "numWeight"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ivBDW", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"intvBW", "[", 
           RowBox[{"i", ",", "j"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "[", 
         RowBox[{"[", "d", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "numBasis"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", "2", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "numWeight"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ivDBW", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"intvBW", "[", 
           RowBox[{"i", ",", "j"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "d", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "numBasis"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", "2", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "numWeight"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ivDBDW", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"intvBW", "[", 
          RowBox[{"i", ",", "j"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"d1", ",", "d2"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "numBasis"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"d1", ",", "2", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"d2", ",", "2", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "numWeight"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"print", "[", "x_", "]"}], ":=", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"StringReplace", "[", 
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"CForm", "[", 
          RowBox[{"x", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], "\.08"}], "]"}], ",", 
       RowBox[{"\"\<,\>\"", "\[Rule]", "\"\< \>\""}]}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "numWeight"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.695750353411593*^9, 3.695750372244224*^9}, {
  3.695750988042419*^9, 3.69575133317483*^9}, {3.695751400945115*^9, 
  3.695751415397868*^9}, {3.6957514623884087`*^9, 3.695751491579233*^9}, {
  3.69575155464589*^9, 3.6957515724859743`*^9}, {3.695751669426588*^9, 
  3.695751762815246*^9}, {3.695752237136445*^9, 3.69575224294879*^9}, {
  3.6957522830954103`*^9, 3.6957522952761803`*^9}, {3.695752463497493*^9, 
  3.695752482894301*^9}, {3.695755246994227*^9, 3.6957552833563013`*^9}, {
  3.695758773728197*^9, 3.6957587786022587`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"print", "[", "ivW", "]"}]], "Input",
 CellChangeTimes->{{3.6957522545825157`*^9, 3.695752255619913*^9}, {
  3.6957527998051443`*^9, 3.695752801687282*^9}, {3.695752867965859*^9, 
  3.6957528723781233`*^9}, {3.6957529241805773`*^9, 3.695753020060301*^9}, {
  3.695753611291519*^9, 3.695753611866064*^9}, {3.6957552899063063`*^9, 
  3.695755291547407*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"\.08 0.0113096860538241\"\>"], "Print",
 CellChangeTimes->{3.6957552918651857`*^9}],

Cell[BoxData["\<\"\.08 0.00502652677639504\"\>"], "Print",
 CellChangeTimes->{3.695755291875247*^9}],

Cell[BoxData["\<\"\.08 0.0193311106128536\"\>"], "Print",
 CellChangeTimes->{3.69575529189459*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"print", "[", "ivDW", "]"}]], "Input",
 CellChangeTimes->{
  3.695753620646578*^9, {3.695755233509313*^9, 3.695755237003365*^9}, {
   3.6957552963854713`*^9, 3.6957553002434397`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"\.08 List(5.34044735894264e-23 \
-1.52284085123323e-20)\"\>"], "Print",
 CellChangeTimes->{3.695755300702785*^9}],

Cell[BoxData["\<\"\.08 List(-0.0708981529323137 -0.070898152372426)\"\>"], \
"Print",
 CellChangeTimes->{3.695755300713071*^9}],

Cell[BoxData["\<\"\.08 List(0.0297221202200581 7.27969516177989e-19)\"\>"], \
"Print",
 CellChangeTimes->{3.695755300726863*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"print", "[", "ivBW", "]"}]], "Input",
 CellChangeTimes->{{3.6957522572862167`*^9, 3.6957522581929502`*^9}, {
  3.695754885798811*^9, 3.6957548894557858`*^9}, {3.695755215552389*^9, 
  3.695755226833452*^9}, {3.6957553042871532`*^9, 3.69575530843639*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"\.08 List(7.6204391582396e-6 0.00439021146652104 \
1.85165520151296e-10 1.34028149944838e-19 2.20937210462966e-6)\"\>"], "Print",\

 CellChangeTimes->{3.6957552271896772`*^9, 3.6957553087093487`*^9}],

Cell[BoxData["\<\"\.08 List(1.10250429298479e-6 1.65931591063708e-15 \
5.87360921647313e-12 3.63105906254424e-13 2.08422293644852e-6)\"\>"], "Print",\

 CellChangeTimes->{3.6957552271896772`*^9, 3.695755308723756*^9}],

Cell[BoxData["\<\"\.08 List(8.24678589871167e-12 0.000492840330440173 \
4.56952959104009e-11 8.14479028124584e-18 6.80742737295506e-20)\"\>"], "Print",\

 CellChangeTimes->{3.6957552271896772`*^9, 3.6957553087370577`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"print", "[", "ivBDW", "]"}]], "Input",
 CellChangeTimes->{{3.695752259819097*^9, 3.695752261523781*^9}, {
  3.695754893937237*^9, 3.695754895589262*^9}, {3.69575531227763*^9, 
  3.6957553176791487`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"\.08 List(-0.000381021940546717 -0.000381021911001781 \
0.0439021774861782 -0.0439020816438352 1.38887234482892e-8 \
1.85182960704813e-8 3.82256704760125e-17 -2.54837076639027e-17 \
-0.0000562897678140114 0.0000844346576942855)\"\>"], "Print",
 CellChangeTimes->{3.6957553182115173`*^9}],

Cell[BoxData["\<\"\.08 List(-0.0000341499555399515 -0.0000405173849903481 \
-6.85349705042447e-14 -1.71325247265605e-13 -5.19794710407911e-10 \
-3.46529806519811e-10 -4.0800014350067e-11 -1.8448761960334e-12 \
-0.0000641299304542042 -0.0000961948954723555)\"\>"], "Print",
 CellChangeTimes->{3.695755318222311*^9}],

Cell[BoxData["\<\"\.08 List(1.05190207856623e-14 -8.27875037320569e-10 \
-0.0096364844146446 0.011075065112276 2.50592245179038e-9 3.75888370108186e-9 \
2.63941246016534e-16 1.31970621984056e-15 8.15186700137521e-18 \
-1.16455243120993e-18)\"\>"], "Print",
 CellChangeTimes->{3.695755318236842*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"print", "[", "ivDBW", "]"}]], "Input",
 CellChangeTimes->{{3.695752263458459*^9, 3.695752268133884*^9}, {
  3.695754899477276*^9, 3.6957549028260393`*^9}, {3.695755321926317*^9, 
  3.695755326327754*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"\.08 List(0.000381021921705068 0.000381021954998888 \
-0.0439020412281449 0.0439020707471192 -1.38887206608625e-8 \
-1.85182994382668e-8 -3.82255770422786e-17 2.54837078232261e-17 \
0.000056289694930816 -0.0000844346454070886)\"\>"], "Print",
 CellChangeTimes->{3.695755326677313*^9}],

Cell[BoxData["\<\"\.08 List(0.0000332692489137675 0.000040219146668623 \
6.85204493850607e-14 1.71324909352809e-13 5.19794710395693e-10 \
3.46529811320057e-10 4.08000129727365e-11 -1.27655314847361e-11 \
0.0000641299265404483 0.0000961948810812043)\"\>"], "Print",
 CellChangeTimes->{3.695755326687192*^9}],

Cell[BoxData["\<\"\.08 List(4.15237706188556e-14 8.27875242601761e-10 \
0.0147578258909096 -0.0110750634847038 -2.50592292629832e-9 \
-3.75888402235963e-9 -2.63941244956407e-16 -1.31970623739893e-15 \
-8.15186700137521e-18 1.16455243120993e-18)\"\>"], "Print",
 CellChangeTimes->{3.695755326699854*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"print", "[", "ivDBDW", "]"}]], "Input",
 CellChangeTimes->{{3.695752269418787*^9, 3.695752272166445*^9}, {
  3.6957549106899443`*^9, 3.6957549130367823`*^9}, {3.695755329909671*^9, 
  3.695755333055299*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"\.08 List(-0.0152408772446579 -0.0190510964385446 \
-0.0190510948828418 -0.0152408774161021 0.43902084586928 0.439020763374942 \
0.439020782258274 0.439020836683411 -9.49062758391844e-7 -1.38887252527424e-6 \
-1.388872335443e-6 -1.75923818830458e-6 -1.04582190746423e-14 \
7.05709254003084e-15 7.05709253758001e-15 -4.57730929374611e-15 \
-0.00115268540086549 0.00215120137421771 0.00215120136101773 \
-0.00294535349647885)\"\>"], "Print",
 CellChangeTimes->{3.695755333521961*^9, 3.6957559217754107`*^9}],

Cell[BoxData["\<\"\.08 List(-0.000906705495236623 -0.00124578357721294 \
-0.00122265516267787 -0.00134789148636764 -2.467363794215e-12 \
-7.02503448654392e-12 -7.02352318762523e-12 -1.7218630131904e-11 \
-4.41324524893222e-8 -3.05767338746002e-8 -3.05767341773979e-8 \
-1.86518404051358e-8 -4.40948671808867e-9 1.43600726485021e-9 \
-2.03885730275897e-10 1.02000037043643e-10 -0.00133192921399387 \
-0.00295984236209982 -0.00295984275315841 -0.00379846451386258)\"\>"], "Print",\

 CellChangeTimes->{3.695755333521961*^9, 3.695755921781692*^9}],

Cell[BoxData["\<\"\.08 List(2.06837253273755e-9 1.05676504446008e-12 \
-4.20526745641468e-12 -8.08154896746868e-8 -0.220885816550459 \
0.216550204404714 0.331636563479064 -0.138127203849001 -1.24785847306852e-7 \
-2.05973201485501e-7 -2.05973188605765e-7 -2.96430205311758e-7 \
-5.71321938167734e-15 -4.17631595812909e-14 -4.17631581914719e-14 \
-2.06176372314079e-13 -9.50656106592901e-16 1.374716569038e-16 \
1.374716569038e-16 -7.99328409154762e-18)\"\>"], "Print",
 CellChangeTimes->{3.695755333521961*^9, 3.695755921791177*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Perform surface integrals", "Subsection",
 CellChangeTimes->{{3.695758641988591*^9, 3.6957586450687037`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"precision", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intsW", "[", "2", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"w", "[", "2", "]"}], "[", 
         RowBox[{"0", ",", "y"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{"ymin", "[", "2", "]"}], ",", 
         RowBox[{"ymax", "[", "2", "]"}]}], "}"}], ",", 
       RowBox[{"WorkingPrecision", "\[Rule]", "precision"}]}], "]"}], ",", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"w", "[", "2", "]"}], "[", 
         RowBox[{"x", ",", "0"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"xmin", "[", "2", "]"}], ",", 
         RowBox[{"xmax", "[", "2", "]"}]}], "}"}], ",", 
       RowBox[{"WorkingPrecision", "\[Rule]", "precision"}]}], "]"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intsBW", "[", "2", "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"bw", "[", 
            RowBox[{"i", ",", "2"}], "]"}], "[", 
           RowBox[{"0", ",", "y"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"ymin", "[", "2", "]"}], ",", 
           RowBox[{"ymax", "[", "2", "]"}]}], "}"}], ",", 
         RowBox[{"WorkingPrecision", "\[Rule]", "precision"}]}], "]"}], ",", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"bw", "[", 
            RowBox[{"i", ",", "2"}], "]"}], "[", 
           RowBox[{"x", ",", "0"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"xmin", "[", "2", "]"}], ",", 
           RowBox[{"xmax", "[", "2", "]"}]}], "}"}], ",", 
         RowBox[{"WorkingPrecision", "\[Rule]", "precision"}]}], "]"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "numBasis"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intsW", "[", "3", "]"}], "=", 
   RowBox[{
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"w", "[", "3", "]"}], "[", 
        RowBox[{"1", ",", "y"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{"ymin", "[", "3", "]"}], ",", 
        RowBox[{"ymax", "[", "3", "]"}]}], "}"}], ",", 
      RowBox[{"WorkingPrecision", "\[Rule]", "precision"}]}], "]"}], "//", 
    "Quiet"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intsBW", "[", "3", "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"bw", "[", 
           RowBox[{"i", ",", "3"}], "]"}], "[", 
          RowBox[{"1", ",", "y"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", 
          RowBox[{"ymin", "[", "3", "]"}], ",", 
          RowBox[{"ymax", "[", "3", "]"}]}], "}"}], ",", 
        RowBox[{"WorkingPrecision", "\[Rule]", "precision"}]}], "]"}], "//", 
      "Quiet"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "numBasis"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.695758701400086*^9, 3.695758759371818*^9}, {
  3.695758790605195*^9, 3.695758865995309*^9}, {3.695759418958372*^9, 
  3.695759475645643*^9}, {3.695759511065516*^9, 3.695759617307926*^9}, {
  3.695759860021948*^9, 3.6957598602358227`*^9}, {3.695759943429085*^9, 
  3.695759983260804*^9}, {3.6957615851312943`*^9, 3.695761589781579*^9}, {
  3.69576165837132*^9, 3.69576168336839*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"isW", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"intsW", "[", "2", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"intsW", "[", "3", "]"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"isBW", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"intsBW", "[", "2", "]"}], "]"}], ",", 
     RowBox[{"Flatten", "[", 
      RowBox[{"intsBW", "[", "3", "]"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"print", "[", "x_", "]"}], ":=", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"StringReplace", "[", 
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"CForm", "[", 
          RowBox[{"x", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], "\.08"}], "]"}], ",", 
       RowBox[{"\"\<,\>\"", "\[Rule]", "\"\< \>\""}]}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"numWeight", "-", "1"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.695759993401266*^9, 3.695760003391326*^9}, {
  3.6957600339043913`*^9, 3.695760083726099*^9}, {3.695760153578814*^9, 
  3.695760186971879*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"print", "[", "isW", "]"}]], "Input",
 CellChangeTimes->{{3.695760173759367*^9, 3.695760175328145*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"\.08 List(0.070898154031541078438 \
0.070898154031541078438)\"\>"], "Print",
 CellChangeTimes->{{3.695760176577375*^9, 3.695760185371573*^9}, 
   3.695760378461725*^9, 3.695761686562273*^9}],

Cell[BoxData["\<\"\.08 List(0.029722120817399189885)\"\>"], "Print",
 CellChangeTimes->{{3.695760176577375*^9, 3.695760185371573*^9}, 
   3.695760378461725*^9, 3.695761686576479*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"print", "[", "isBW", "]"}]], "Input",
 CellChangeTimes->{{3.6957601915282087`*^9, 3.695760194955777*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"\.08 List(8.8070222123627288684e-7 2.9823494965834785188e-7 \
1.4523602234679285669e-17 0.e-20 0.e-20 0.e-20 0.e-20 \
1.4610407586686105595e-11 0.e-20 0.e-20)\"\>"], "Print",
 CellChangeTimes->{3.695760195327182*^9, 3.695760382607933*^9, 
  3.695761687990492*^9}],

Cell[BoxData["\<\"\.08 List(5.2042791299968001669e-14 \
0.0051213383391328205805 0.e-20 0.e-20 0.e-20)\"\>"], "Print",
 CellChangeTimes->{3.695760195327182*^9, 3.695760382607933*^9, 
  3.6957616880054283`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1031, 856},
WindowMargins->{{Automatic, 259}, {Automatic, 21}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September 9, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 89, 1, 92, "Title"],
Cell[CellGroupData[{
Cell[694, 27, 96, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[815, 32, 145, 2, 64, "Section"],
Cell[CellGroupData[{
Cell[985, 38, 102, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[1112, 43, 329, 8, 46, "Input"],
Cell[1444, 53, 136, 3, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1617, 61, 699, 21, 70, "Input"],
Cell[2319, 84, 1310, 38, 72, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[3678, 128, 102, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[3805, 133, 449, 12, 46, "Input"],
Cell[4257, 147, 230, 8, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4524, 160, 901, 29, 50, "Input"],
Cell[5428, 191, 1268, 39, 71, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[6745, 236, 102, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[6872, 241, 449, 12, 46, "Input"],
Cell[7324, 255, 121, 3, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7482, 263, 1240, 39, 50, "Input"],
Cell[8725, 304, 1000, 29, 47, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[9774, 339, 102, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[9901, 344, 595, 16, 46, "Input"],
Cell[10499, 362, 331, 11, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10867, 378, 1248, 38, 67, "Input"],
Cell[12118, 418, 2348, 72, 108, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[14515, 496, 102, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[14642, 501, 591, 16, 52, "Input"],
Cell[15236, 519, 202, 5, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15475, 529, 1737, 54, 76, "Input"],
Cell[17215, 585, 1326, 41, 84, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[18614, 634, 109, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[18748, 639, 88, 1, 64, "Section"],
Cell[18839, 642, 5045, 150, 288, "Input"],
Cell[CellGroupData[{
Cell[23909, 796, 3869, 118, 185, "Input"],
Cell[27781, 916, 964, 28, 49, "Output"],
Cell[28748, 946, 746, 25, 56, "Output"],
Cell[29497, 973, 922, 32, 52, "Output"],
Cell[30422, 1007, 543, 15, 47, "Output"],
Cell[30968, 1024, 568, 16, 48, "Output"],
Cell[31539, 1042, 598, 17, 48, "Output"],
Cell[32140, 1061, 603, 17, 48, "Output"],
Cell[32746, 1080, 1931, 57, 51, "Output"],
Cell[34680, 1139, 825, 24, 49, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[35554, 1169, 102, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[35681, 1174, 109, 1, 44, "Subsection"],
Cell[35793, 1177, 4732, 124, 308, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40562, 1306, 187, 2, 44, "Subsection"],
Cell[40752, 1310, 9584, 277, 658, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50373, 1592, 160, 2, 44, "Subsection"],
Cell[CellGroupData[{
Cell[50558, 1598, 1684, 35, 46, "Input"],
Cell[52245, 1635, 543, 11, 24, "Message"],
Cell[52791, 1648, 792, 22, 46, "Output"]
}, Open  ]],
Cell[53598, 1673, 1141, 30, 80, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54776, 1708, 160, 2, 44, "Subsection"],
Cell[54939, 1712, 4289, 125, 131, "Input"],
Cell[CellGroupData[{
Cell[59253, 1841, 378, 6, 28, "Input"],
Cell[CellGroupData[{
Cell[59656, 1851, 101, 1, 21, "Print"],
Cell[59760, 1854, 100, 1, 21, "Print"],
Cell[59863, 1857, 98, 1, 21, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[60010, 1864, 206, 4, 28, "Input"],
Cell[CellGroupData[{
Cell[60241, 1872, 131, 2, 21, "Print"],
Cell[60375, 1876, 127, 2, 21, "Print"],
Cell[60505, 1880, 128, 2, 21, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[60682, 1888, 278, 4, 28, "Input"],
Cell[CellGroupData[{
Cell[60985, 1896, 217, 3, 21, "Print"],
Cell[61205, 1901, 217, 3, 21, "Print"],
Cell[61425, 1906, 221, 3, 21, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[61695, 1915, 227, 4, 28, "Input"],
Cell[CellGroupData[{
Cell[61947, 1923, 305, 4, 37, "Print"],
Cell[62255, 1929, 314, 4, 37, "Print"],
Cell[62572, 1935, 298, 4, 37, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[62919, 1945, 228, 4, 28, "Input"],
Cell[CellGroupData[{
Cell[63172, 1953, 302, 4, 37, "Print"],
Cell[63477, 1959, 306, 4, 37, "Print"],
Cell[63786, 1965, 302, 4, 37, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[64137, 1975, 231, 4, 28, "Input"],
Cell[CellGroupData[{
Cell[64393, 1983, 523, 7, 67, "Print"],
Cell[64919, 1992, 544, 8, 67, "Print"],
Cell[65466, 2002, 532, 7, 67, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[66059, 2016, 115, 1, 44, "Subsection"],
Cell[66177, 2019, 4186, 117, 148, "Input"],
Cell[70366, 2138, 1208, 36, 63, "Input"],
Cell[CellGroupData[{
Cell[71599, 2178, 126, 2, 28, "Input"],
Cell[CellGroupData[{
Cell[71750, 2184, 208, 3, 21, "Print"],
Cell[71961, 2189, 182, 2, 21, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[72192, 2197, 129, 2, 28, "Input"],
Cell[CellGroupData[{
Cell[72346, 2203, 281, 4, 37, "Print"],
Cell[72630, 2209, 209, 3, 21, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
