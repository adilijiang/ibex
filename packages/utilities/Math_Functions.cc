#include "Math_Functions.hh"

#include "Check.hh"

#include <cmath>
#include <cstdlib>

namespace Math_Functions
{
using namespace std;
    
int factorial(int n)
{
    int val = 1;
        
    for (int i = n; i >= 1; --i)
    {
        val *= i; 
    }
        
    return val;

    // return (n == 0) ? 1 : n * factorial(n - 1);
}
    
int factorial2(int n)
{
    int val = 1;
        
    for (int i = n; i >=1; i -= 2)
    {
        val *= i;
    }

    return val;
}

double legendre_polynomial_rec(int l,
                               double const &x)
{
    if (l == 0)
    {
        return 1;
    }
        
    double plm2 = 0;
    double plm1 = 1;
    double pl = x;
    
    for (int i = 2; i <= l; ++i)
    {
        double j = static_cast<double>(i);
        
        plm2 = plm1;
        plm1 = pl;
        pl = ((2 * j - 1) * x * plm1 - (j - 1) * plm2) / j;
    }
        
    return pl;
}
    
double legendre_polynomial(int l,
                           int m,
                           double const &x)
{
    if (l == m)
    {
        return factorial2(2 * l - 1) * pow(1. - x * x, l / 2.);
    }
    else if (l == m + 1)
    {
        return factorial2(2 * l - 1) * x * pow(1. - x * x, (l - 1.) / 2.);
    }

    double p2 = 0;
    double p1 = factorial2(2 * m - 1) * pow(1. - x * x, m / 2.);
    double p = x * (2 * m + 1) * p1;
        
    for (int i = m + 2; i <= l; ++i)
    {
        p2 = p1;
        p1 = p;
            
        p =  (x * (2 * i - 1.) * p1 - (i + m - 1.) * p2) / (i - m);
    }
        
    return p;
}

double spherical_harmonic_rec(int l,
                              int m,
                              double const &mu,
                              double const &phi)
{
    double val = (m == 0) ? 1 : 0;
        
    val = sqrt((2 - val) * factorial(l - std::abs(m)) / factorial(l + std::abs(m)));
        
    double t = (m >= 0) ? cos(m * phi) : sin(std::abs(m) * phi);
        
    return val * legendre_polynomial(l, std::abs(m), mu) * t;
}

double spherical_harmonic_rec(int l,
                              int m,
                              double const &x,
                              double const &y,
                              double const &z)
{
    double mu;
    double phi;
        
    xyz_to_spherical(x, y, z, mu, phi);
        
    return spherical_harmonic_rec(l, m, mu, phi);
}

double spherical_harmonic(int l,
                          int m,
                          double const &x,
                          double const &y,
                          double const &z)
{
    switch(l)
    {
    case 0:
        return 1;
    case 1:
        switch(m)
        {
        case -1:
            return z;
        case 0:
            return x;
        case 1:
            return y;
        default:
            AssertMsg(false, "Could not find moment");
            break;
        }
    case 2:
        switch(m)
        {
        case -2:
            return sqrt(3.) * y * z;
        case -1:
            return sqrt(3.) * x * z;
        case 0:
            return 0.5 * (3. * x * x - 1.);
        case 1:
            return sqrt(3.) * x * y;
        case 2:
            return 0.5 * sqrt(3.) * (y * y - z * z);
        default:
            AssertMsg(false, "Could not find moment");
            break;
        }
    case 3:
        switch(m)
        {
        case -3:
            return sqrt(0.625) * z * (3. * y * y - z * z);
        case -2:
            return sqrt(15.) * x * y * z;
        case -1:
            return sqrt(0.375) * z * (5. * x * x - 1);
        case 0:
            return 0.5 * x * (5. * x * x - 3.);
        case 1:
            return sqrt(0.375) * y * (5. * x * x - 1.);
        case 2:
            return sqrt(3.75) * x * (y * y - z * z);
        case 3:
            return sqrt(0.625) * y * (y * y - 3 * z * z);
        default:
            AssertMsg(false, "Could not find moment");
            break;
        }
    default:
        return spherical_harmonic_rec(l, m, x, y, z);
    }
}
    
// See file sphere_lebedev_rule.cpp for original conversion code
void xyz_to_spherical(double const &x,
                      double const &y,
                      double const &z,
                      double &mu,
                      double &phi)
{
    double val = sqrt(y * y + z * z);
        
    if (val > 0)
    {
        phi = acos(y / val);
    }
    else
    {
        phi = acos(y);
    }
        
    if (z < 0)
    {
        phi = -phi;
    }
        
    mu = x;
}
    
void spherical_to_xyz(double const &mu,
                      double const &phi,
                      double &x,
                      double &y,
                      double &z)
{
    double val = sqrt(1 - mu * mu);
        
    x = mu;
    y = cos(phi) * val;
    z = sin(phi) * val;
}

double legendre_polynomial(int l,
                           double const &x)
{
    switch(l)
    {
    case 0:
        return 1.;
    case 1:
        return x;
    case 2:
        return -0.5 + 1.5*pow(x,2);
    case 3:
        return -1.5*x + 2.5*pow(x,3);
    case 4:
        return 0.375 - 3.75*pow(x,2) + 4.375*pow(x,4);
    case 5:
        return 1.875*x - 8.75*pow(x,3) + 7.875*pow(x,5);
    case 6:
        return -0.3125 + 6.5625*pow(x,2) - 19.6875*pow(x,4) + 14.4375*pow(x,6);
    case 7:
        return -2.1875*x + 19.6875*pow(x,3) - 43.3125*pow(x,5) + 26.8125*pow(x,7);
    case 8:
        return 0.2734375 - 9.84375*pow(x,2) + 54.140625*pow(x,4) - 93.84375*pow(x,6) + 50.2734375*pow(x,8);
    case 9:
        return 2.4609375*x - 36.09375*pow(x,3) + 140.765625*pow(x,5) - 201.09375*pow(x,7) + 94.9609375*pow(x,9);
    case 10:
        return -0.24609375 + 13.53515625*pow(x,2) - 117.3046875*pow(x,4) + 351.9140625*pow(x,6) - 427.32421875*pow(x,8) + 180.42578125*pow(x,10);
    case 11:
        return -2.70703125*x + 58.65234375*pow(x,3) - 351.9140625*pow(x,5) + 854.6484375*pow(x,7) - 902.12890625*pow(x,9) + 344.44921875*pow(x,11);
    case 12:
        return 0.2255859375 - 17.595703125*pow(x,2) + 219.9462890625*pow(x,4) - 997.08984375*pow(x,6) + 2029.7900390625*pow(x,8) - 1894.470703125*pow(x,10) + 660.1943359375*pow(x,12);
    case 13:
        return 2.9326171875*x - 87.978515625*pow(x,3) + 747.8173828125*pow(x,5) - 2706.38671875*pow(x,7) + 4736.1767578125*pow(x,9) - 3961.166015625*pow(x,11) + 1269.6044921875*pow(x,13);
    case 14:
        return -0.20947265625 + 21.99462890625*pow(x,2) - 373.90869140625*pow(x,4) + 2368.08837890625*pow(x,6) - 7104.26513671875*pow(x,8) + 10893.20654296875*pow(x,10) - 8252.42919921875*pow(x,12) + 2448.52294921875*pow(x,14);
    case 15:
        return -3.14208984375*x + 124.63623046875*pow(x,3) - 1420.85302734375*pow(x,5) + 7104.26513671875*pow(x,7) - 18155.34423828125*pow(x,9) + 24757.28759765625*pow(x,11) - 17139.66064453125*pow(x,13) + 4733.81103515625*pow(x,15);
    case 16:
        return 0.196380615234375 - 26.707763671875*pow(x,2) + 592.0220947265625*pow(x,4) - 4972.985595703125*pow(x,6) + 20424.762268066406*pow(x,8) - 45388.360595703125*pow(x,10) + 55703.89709472656*pow(x,12) - 35503.582763671875*pow(x,14) + 9171.758880615234*pow(x,16);
    case 17:
        return 3.338470458984375*x - 169.149169921875*pow(x,3) + 2486.4927978515625*pow(x,5) - 16339.809814453125*pow(x,7) + 56735.450744628906*pow(x,9) - 111407.79418945312*pow(x,11) + 124262.53967285156*pow(x,13) - 73374.07104492188*pow(x,15) + 17804.002532958984*pow(x,17);
    case 18:
        return -0.1854705810546875 + 31.715469360351562*pow(x,2) - 888.0331420898438*pow(x,4) + 9531.555725097656*pow(x,6) - 51061.905670166016*pow(x,8) + 153185.71701049805*pow(x,10) - 269235.5026245117*pow(x,12) + 275152.76641845703*pow(x,14) - 151334.02153015137*pow(x,16) + 34618.893814086914*pow(x,18);
    case 19:
        return -3.5239410400390625*x + 222.00828552246094*pow(x,3) - 4084.9524536132812*pow(x,5) + 34041.270446777344*pow(x,7) - 153185.71701049805*pow(x,9) + 403853.2539367676*pow(x,11) - 642023.1216430664*pow(x,13) + 605336.0861206055*pow(x,15) - 311570.0443267822*pow(x,17) + 67415.74058532715*pow(x,19);
    case 20:
        return 0.17619705200195312 - 37.001380920410156*pow(x,2) + 1276.5476417541504*pow(x,4) - 17020.635223388672*pow(x,6) + 114889.28775787354*pow(x,8) - 444238.57933044434*pow(x,10) + 1.0432875726699829e6*pow(x,12) - 1.5133402153015137e6*pow(x,14) + 1.3241726883888245e6*pow(x,16) - 640449.5355606079*pow(x,18) + 131460.69414138794*pow(x,20);
    case 21:
        return 3.7001380920410156*x - 283.67725372314453*pow(x,3) + 6382.738208770752*pow(x,5) - 65651.02157592773*pow(x,7) + 370198.8161087036*pow(x,9) - 1.2519450872039795e6*pow(x,11) + 2.648345376777649e6*pow(x,13) - 3.5311271690368652e6*pow(x,15) + 2.8820229100227356e6*pow(x,17) - 1.3146069414138794e6*pow(x,19) + 256661.35522842407*pow(x,21);
    case 22:
        return -0.16818809509277344 + 42.55158805847168*pow(x,2) - 1772.9828357696533*pow(x,4) + 28722.321939468384*pow(x,6) - 237984.95321273804*pow(x,8) + 1.1476163299369812e6*pow(x,10) - 3.4428489898109436e6*pow(x,12) + 6.620863441944122e6*pow(x,14) - 8.165731578397751e6*pow(x,16) + 6.244382971715927e6*pow(x,18) - 2.6949442298984528e6*pow(x,20) + 501656.2852191925*pow(x,22);
    case 23:
        return -3.868326187133789*x + 354.59656715393066*pow(x,3) - 9574.107313156128*pow(x,5) + 118992.47660636902*pow(x,7) - 819725.9499549866*pow(x,9) + 3.4428489898109436e6*pow(x,11) - 9.269208818721771e6*pow(x,13) + 1.6331463156795502e7*pow(x,15) - 1.873314891514778e7*pow(x,17) + 1.3474721149492264e7*pow(x,19) - 5.518219137411118e6*pow(x,21) + 981501.427602768*pow(x,23);
    case 24:
        return 0.1611802577972412 - 48.35407733917236*pow(x,2) + 2393.526828289032*pow(x,4) - 46274.85201358795*pow(x,6) + 461095.84684967995*pow(x,8) - 2.7050956348514557e6*pow(x,10) + 1.0041642886948586e7*pow(x,12) - 2.4497194735193253e7*pow(x,14) + 3.9807941444689035e7*pow(x,16) - 4.26699503067255e7*pow(x,18) + 2.8970650471408367e7*pow(x,20) - 1.1287266417431831e7*pow(x,22) + 1.922106962388754e6*pow(x,24);
    case 25:
        return 4.02950644493103*x - 435.18669605255127*pow(x,3) + 13882.455604076385*pow(x,5) - 204931.48748874664*pow(x,7) + 1.6906847717821598e6*pow(x,9) - 8.607122474527359e6*pow(x,11) + 2.8580060524392128e7*pow(x,13) - 6.369270631150246e7*pow(x,15) + 9.600738819013238e7*pow(x,17) - 9.656883490469456e7*pow(x,19) + 6.207996529587507e7*pow(x,21) - 2.3065283548665047e7*pow(x,23) + 3.7673296462819576e6*pow(x,25);
    case 26:
        return -0.15498101711273193 + 54.39833700656891*pow(x,2) - 3155.1035463809967*pow(x,4) + 71726.02062106133*pow(x,6) - 845342.3858910799*pow(x,8) + 5.917396701237559e6*pow(x,10) - 2.653862762979269e7*pow(x,12) + 7.961588288937807e7*pow(x,14) - 1.6321255992322505e8*pow(x,16) + 2.2935098289864957e8*pow(x,18) - 2.1727987853556275e8*pow(x,20) + 1.3262538040482402e8*pow(x,22) - 4.709162057852447e7*pow(x,24) + 7.389761998476148e6*pow(x,26);
    case 27:
        return -4.184487462043762*x + 525.8505910634995*pow(x,3) - 19561.64198756218*pow(x,5) + 338136.95435643196*pow(x,7) - 3.287442611798644e6*pow(x,9) + 1.9903970722344518e7*pow(x,11) - 7.961588288937807e7*pow(x,13) + 2.1761674656430006e8*pow(x,15) - 4.1283176921756923e8*pow(x,17) + 5.431996963389069e8*pow(x,19) - 4.8629306148435473e8*pow(x,21) + 2.825497234711468e8*pow(x,23) - 9.606690598018992e7*pow(x,25) + 1.4505829108119845e7*pow(x,27);
    case 28:
        return 0.14944598078727722 - 60.67506819963455*pow(x,2) + 4075.3420807421207*pow(x,4) - 107589.03093159199*pow(x,6) + 1.4793491753093898e6*pow(x,8) - 1.2163537663654983e7*pow(x,10) + 6.468790484761968e7*pow(x,12) - 2.331607998903215e8*pow(x,14) + 5.848450063915564e8*pow(x,16) - 1.0320794230439231e9*pow(x,18) + 1.2765192863964312e9*pow(x,20) - 1.0831072733060627e9*pow(x,22) + 6.00418162376187e8*pow(x,24) - 1.958286929596179e8*pow(x,26) + 2.8493592890949696e7*pow(x,28);
    case 29:
        return 4.333933442831039*x - 626.975704729557*pow(x,3) + 26897.257732897997*pow(x,5) - 537945.1546579599*pow(x,7) + 6.0817688318274915e6*pow(x,9) - 4.312526989841312e7*pow(x,11) + 2.040156999040313e8*pow(x,13) - 6.683942930189216e8*pow(x,15) + 1.5481191345658846e9*pow(x,17) - 2.5530385727928624e9*pow(x,19) + 2.978545001591673e9*pow(x,21) - 2.401672649504748e9*pow(x,23) + 1.2728865042375164e9*pow(x,25) - 3.9891030047329575e8*pow(x,27) + 5.6004648096004575e7*pow(x,29);
    case 30:
        return -0.14446444809436798 + 67.17596836388111*pow(x,2) - 5172.549564018846*pow(x,4) + 156900.67010857165*pow(x,6) - 2.4879963402930647e6*pow(x,8) + 2.3718898444127217e7*pow(x,10) - 1.4734467215291148e8*pow(x,12) + 6.26619649705239e8*pow(x,14) - 1.879858949115717e9*pow(x,16) + 4.042311073588699e9*pow(x,18) - 6.254944503342513e9*pow(x,20) + 6.904808867326151e9*pow(x,22) - 5.303693767656319e9*pow(x,24) + 2.6926445281947465e9*pow(x,26) - 8.120673973920664e8*pow(x,28) + 1.10142474588809e8*pow(x,30);
    case 31:
        return -4.478397890925407*x + 738.9356520026922*pow(x,3) - 36207.84694813192*pow(x,5) + 829332.1134310216*pow(x,7) - 1.078131747460328e7*pow(x,9) + 8.84068032917469e7*pow(x,11) - 4.8737083865963036e8*pow(x,13) + 1.879858949115717e9*pow(x,15) - 5.197257094614041e9*pow(x,17) + 1.0424907505570854e10*pow(x,19) - 1.519057950811753e10*pow(x,21) + 1.5911081302968956e10*pow(x,23) - 1.16681262888439e10*pow(x,25) + 5.684471781744465e9*pow(x,27) - 1.652137118832135e9*pow(x,29) + 2.1673196612636608e8*pow(x,31);
    case 32:
        return 0.13994993409141898 - 73.89356520026922*pow(x,2) + 6465.686955023557*pow(x,4) - 223281.7228468135*pow(x,6) + 4.04299405297623e6*pow(x,8) - 4.420340164587345e7*pow(x,10) + 3.1679104512875974e8*pow(x,12) - 1.5665491242630975e9*pow(x,14) + 5.522085663027419e9*pow(x,16) - 1.4148088757560446e10*pow(x,18) + 2.658351413920568e10*pow(x,20) - 3.65954869968286e10*pow(x,22) + 3.646289465263719e10*pow(x,24) - 2.558012301785009e10*pow(x,26) + 1.1977994111532978e10*pow(x,28) - 3.3593454749586744e9*pow(x,30) + 4.2669105831128323e8*pow(x,32);
    case 33:
        return 4.618347825016826*x - 862.0915940031409*pow(x,3) + 47846.08346717432*pow(x,5) - 1.2439981701465324e6*pow(x,7) + 1.8418084019113936e7*pow(x,9) - 1.7279511552477804e8*pow(x,11) + 1.0965843869841683e9*pow(x,13) - 4.908520589357706e9*pow(x,15) + 1.59165998522555e10*pow(x,17) - 3.797644877029383e10*pow(x,19) + 6.709172616085243e10*pow(x,21) - 8.751094716632925e10*pow(x,23) + 8.313539980801279e10*pow(x,25) - 5.5897305853820564e10*pow(x,27) + 2.519509106219006e10*pow(x,29) - 6.827056932980532e9*pow(x,31) + 8.404520845525277e8*pow(x,33);
    case 34:
        return -0.13583375955931842 + 80.82108693779446*pow(x,2) - 7974.347244529054*pow(x,4) + 310999.5425366331*pow(x,6) - 6.375490622000978e6*pow(x,8) + 7.919776128218994e7*pow(x,10) - 6.479816832179176e8*pow(x,12) + 3.681390442018279e9*pow(x,14) - 1.5032344304907974e10*pow(x,16) + 4.509703291472392e10*pow(x,18) - 1.0063758924127864e11*pow(x,20) + 1.6772931540213107e11*pow(x,22) - 2.0783849952003198e11*pow(x,24) + 1.886534072566444e11*pow(x,26) - 1.2177627346725195e11*pow(x,28) + 5.290969123059912e10*pow(x,30) - 1.3867459395116705e10*pow(x,32) + 1.6561849901476278e9*pow(x,34);
    case 35:
        return -4.754181584576145*x + 996.7934055661317*pow(x,3) - 62199.90850732662*pow(x,5) + 1.8215687491431367e6*pow(x,7) - 3.0460677416226897e7*pow(x,9) + 3.239908416089588e8*pow(x,11) - 2.342703008557087e9*pow(x,13) + 1.2025875443926378e10*pow(x,15) - 4.509703291472392e10*pow(x,17) + 1.257969865515983e11*pow(x,19) - 2.635746384890631e11*pow(x,21) + 4.1567699904006396e11*pow(x,23) - 4.9049885886727545e11*pow(x,25) + 4.2621695713538184e11*pow(x,27) - 2.645484561529956e11*pow(x,29) + 1.1093967516093364e11*pow(x,31) - 2.8155144832509674e10*pow(x,33) + 3.265050409148181e9*pow(x,35);
    case 36:
        return 0.13206059957155958 - 87.95235931465868*pow(x,2) + 9718.735704269784*pow(x,4) - 425032.70813339856*pow(x,6) + 9.79093202664436e6*pow(x,8) - 1.3707304837302104e8*pow(x,10) + 1.2689641296350887e9*pow(x,12) - 8.199460529949803e9*pow(x,14) + 3.8332477977515335e10*pow(x,16) - 1.327857080266871e11*pow(x,18) + 3.459417130168953e11*pow(x,20) - 6.828979269943907e11*pow(x,22) + 1.0218726226401572e12*pow(x,24) - 1.150785784265531e12*pow(x,26) + 9.589881535546091e11*pow(x,28) - 5.731883216648239e11*pow(x,30) + 2.322799448682048e11*pow(x,32) - 5.713838216009316e10*pow(x,34) + 6.439404973597801e9*pow(x,36);
    case 37:
        return 4.886242184147704*x - 1143.3806710905628*pow(x,3) + 79693.63277501223*pow(x,5) - 2.6109152071051626e6*pow(x,7) + 4.89546601332218e7*pow(x,9) - 5.856757521392717e8*pow(x,11) + 4.783018642470718e9*pow(x,13) - 2.7878165801829334e10*pow(x,15) + 1.1950713722401839e11*pow(x,17) - 3.843796811298837e11*pow(x,19) + 9.389846496172874e11*pow(x,21) - 1.751781638811698e12*pow(x,23) + 2.493369199241984e12*pow(x,25) - 2.6851668299529053e12*pow(x,27) + 2.1494562062430894e12*pow(x,29) - 1.2388263726304258e12*pow(x,31) + 4.856762483607919e11*pow(x,33) - 1.1590928952476042e11*pow(x,35) + 1.2704771974936201e10*pow(x,37);
    case 38:
        return -0.1285853206354659 + 95.28172259088024*pow(x,2) - 11719.651878678269*pow(x,4) + 571137.7015542543*pow(x,6) - 1.4686398039966539e7*pow(x,8) + 2.3008690262614244e8*pow(x,10) - 2.391509321235359e9*pow(x,12) + 1.7423853626143333e10*pow(x,14) - 9.234642421855966e10*pow(x,16) + 3.651606970733895e11*pow(x,18) - 1.0954820912201686e12*pow(x,20) + 2.518186105791816e12*pow(x,22) - 4.452444998646399e12*pow(x,24) + 6.041625367394037e12*pow(x,26) - 6.233422998104959e12*pow(x,28) + 4.800452193942899e12*pow(x,30) - 2.6712193659843555e12*pow(x,32) + 1.0142062833416537e12*pow(x,34) - 2.3503828153631973e11*pow(x,36) + 2.5075207845268818e10*pow(x,38);
    case 39:
        return -5.01482750478317*x + 1302.1835420753632*pow(x,3) - 100789.00615663311*pow(x,5) + 3.6715995099916346e6*pow(x,7) - 7.669563420871416e7*pow(x,9) + 1.0249325662437254e9*pow(x,11) - 9.382075029461794e9*pow(x,13) + 6.156428281237311e10*pow(x,15) - 2.9876784306004596e11*pow(x,17) + 1.0954820912201686e12*pow(x,19) - 3.0777830181899976e12*pow(x,21) + 6.678667497969599e12*pow(x,23) - 1.1220161396588926e13*pow(x,25) + 1.4544653662244904e13*pow(x,27) - 1.44013565818287e13*pow(x,29) + 1.0684877463937422e13*pow(x,31) - 5.747168938936037e12*pow(x,33) + 2.1153445338268777e12*pow(x,35) - 4.7642894906010754e11*pow(x,37) + 4.950746164322305e10*pow(x,39);
    case 40:
        return 0.12537068761957926 - 102.80396384805499*pow(x,2) + 13998.473077310155*pow(x,4) - 755917.5461747483*pow(x,6) + 2.1570647121200856e7*pow(x,8) - 3.758086076226993e8*pow(x,10) + 4.355963406535833e9*pow(x,12) - 3.5517855468676796e10*pow(x,14) + 2.1162722216753256e11*pow(x,16) - 9.460981696901456e11*pow(x,18) + 3.231672169099497e12*pow(x,20) - 8.533852914072266e12*pow(x,22) + 1.7531502182170197e13*pow(x,24) - 2.8050403491472316e13*pow(x,26) + 3.4803278406086023e13*pow(x,28) - 3.3123120138206008e13*pow(x,30) + 2.3707071873111152e13*pow(x,32) - 1.2339509780656787e13*pow(x,34) + 4.406967778805995e12*pow(x,36) - 9.653955020428496e11*pow(x,38) + 9.777723674536554e10*pow(x,40);
    default:
        return legendre_polynomial_rec(l,
                                       x);
    }
}

double d_legendre_polynomial(int l,
                             double const &x)
{
    switch(l)
    {
    case 0:
        return 0;
    case 1:
        return 1;
    case 2:
        return 3.*x;
    case 3:
        return -1.5 + 7.5*pow(x,2);
    case 4:
        return -7.5*x + 17.5*pow(x,3);
    case 5:
        return 1.875 - 26.25*pow(x,2) + 39.375*pow(x,4);
    case 6:
        return 13.125*x - 78.75*pow(x,3) + 86.625*pow(x,5);
    case 7:
        return -2.1875 + 59.0625*pow(x,2) - 216.5625*pow(x,4) + 187.6875*pow(x,6);
    case 8:
        return -19.6875*x + 216.5625*pow(x,3) - 563.0625*pow(x,5) + 402.1875*pow(x,7);
    case 9:
        return 2.4609375 - 108.28125*pow(x,2) + 703.828125*pow(x,4) - 1407.65625*pow(x,6) + 854.6484375*pow(x,8);
    case 10:
        return 27.0703125*x - 469.21875*pow(x,3) + 2111.484375*pow(x,5) - 3418.59375*pow(x,7) + 1804.2578125*pow(x,9);
    case 11:
        return -2.70703125 + 175.95703125*pow(x,2) - 1759.5703125*pow(x,4) + 5982.5390625*pow(x,6) - 8119.16015625*pow(x,8) + 3788.94140625*pow(x,10);
    case 12:
        return -35.19140625*x + 879.78515625*pow(x,3) - 5982.5390625*pow(x,5) + 16238.3203125*pow(x,7) - 18944.70703125*pow(x,9) + 7922.33203125*pow(x,11);
    case 13:
        return 2.9326171875 - 263.935546875*pow(x,2) + 3739.0869140625*pow(x,4) - 18944.70703125*pow(x,6) + 42625.5908203125*pow(x,8) - 43572.826171875*pow(x,10) + 16504.8583984375*pow(x,12);
    case 14:
        return 43.9892578125*x - 1495.634765625*pow(x,3) + 14208.5302734375*pow(x,5) - 56834.12109375*pow(x,7) + 108932.0654296875*pow(x,9) - 99029.150390625*pow(x,11) + 34279.3212890625*pow(x,13);
    case 15:
        return -3.14208984375 + 373.90869140625*pow(x,2) - 7104.26513671875*pow(x,4) + 49729.85595703125*pow(x,6) - 163398.09814453125*pow(x,8) + 272330.16357421875*pow(x,10) - 222815.58837890625*pow(x,12) + 71007.16552734375*pow(x,14);
    case 16:
        return -53.41552734375*x + 2368.08837890625*pow(x,3) - 29837.91357421875*pow(x,5) + 163398.09814453125*pow(x,7) - 453883.60595703125*pow(x,9) + 668446.7651367188*pow(x,11) - 497050.15869140625*pow(x,13) + 146748.14208984375*pow(x,15);
    case 17:
        return 3.338470458984375 - 507.447509765625*pow(x,2) + 12432.463989257812*pow(x,4) - 114378.66870117188*pow(x,6) + 510619.05670166016*pow(x,8) - 1.2254857360839844e6*pow(x,10) + 1.6154130157470703e6*pow(x,12) - 1.1006110656738281e6*pow(x,14) + 302668.04306030273*pow(x,16);
    case 18:
        return 63.430938720703125*x - 3552.132568359375*pow(x,3) + 57189.33435058594*pow(x,5) - 408495.2453613281*pow(x,7) + 1.5318571701049805e6*pow(x,9) - 3.2308260314941406e6*pow(x,11) + 3.8521387298583984e6*pow(x,13) - 2.421344344482422e6*pow(x,15) + 623140.0886535645*pow(x,17);
    case 19:
        return -3.5239410400390625 + 666.0248565673828*pow(x,2) - 20424.762268066406*pow(x,4) + 238288.8931274414*pow(x,6) - 1.3786714530944824e6*pow(x,8) + 4.442385793304443e6*pow(x,10) - 8.346300581359863e6*pow(x,12) + 9.080041291809082e6*pow(x,14) - 5.296690753555298e6*pow(x,16) + 1.2808990711212158e6*pow(x,18);
    case 20:
        return -74.00276184082031*x + 5106.190567016602*pow(x,3) - 102123.81134033203*pow(x,5) + 919114.3020629883*pow(x,7) - 4.442385793304443e6*pow(x,9) + 1.2519450872039795e7*pow(x,11) - 2.118676301422119e7*pow(x,13) + 2.118676301422119e7*pow(x,15) - 1.1528091640090942e7*pow(x,17) + 2.629213882827759e6*pow(x,19);
    case 21:
        return 3.7001380920410156 - 851.0317611694336*pow(x,2) + 31913.69104385376*pow(x,4) - 459557.15103149414*pow(x,6) + 3.3317893449783325e6*pow(x,8) - 1.3771395959243774e7*pow(x,10) + 3.4428489898109436e7*pow(x,12) - 5.296690753555298e7*pow(x,14) + 4.8994389470386505e7*pow(x,16) - 2.497753188686371e7*pow(x,18) + 5.3898884597969055e6*pow(x,20);
    case 22:
        return 85.10317611694336*x - 7091.931343078613*pow(x,3) + 172333.9316368103*pow(x,5) - 1.9038796257019043e6*pow(x,7) + 1.1476163299369812e7*pow(x,9) - 4.131418787773132e7*pow(x,11) + 9.269208818721771e7*pow(x,13) - 1.3065170525436401e8*pow(x,15) + 1.1239889349088669e8*pow(x,17) - 5.3898884597969055e7*pow(x,19) + 1.1036438274822235e7*pow(x,21);
    case 23:
        return -3.868326187133789 + 1063.789701461792*pow(x,2) - 47870.53656578064*pow(x,4) + 832947.3362445831*pow(x,6) - 7.377533549594879e6*pow(x,8) + 3.787133888792038e7*pow(x,10) - 1.2049971464338303e8*pow(x,12) + 2.4497194735193253e8*pow(x,14) - 3.184635315575123e8*pow(x,16) + 2.56019701840353e8*pow(x,18) - 1.1588260188563347e8*pow(x,20) + 2.2574532834863663e7*pow(x,22);
    case 24:
        return -96.70815467834473*x + 9574.107313156128*pow(x,3) - 277649.1120815277*pow(x,5) + 3.6887667747974396e6*pow(x,7) - 2.7050956348514557e7*pow(x,9) + 1.2049971464338303e8*pow(x,11) - 3.4296072629270554e8*pow(x,13) + 6.369270631150246e8*pow(x,15) - 7.68059105521059e8*pow(x,17) + 5.794130094281673e8*pow(x,19) - 2.483198611835003e8*pow(x,21) + 4.613056709733009e7*pow(x,23);
    case 25:
        return 4.02950644493103 - 1305.5600881576538*pow(x,2) + 69412.27802038193*pow(x,4) - 1.4345204124212265e6*pow(x,6) + 1.5216162946039438e7*pow(x,8) - 9.467834721980095e7*pow(x,10) + 3.7154078681709766e8*pow(x,12) - 9.553905946725368e8*pow(x,14) + 1.6321255992322505e9*pow(x,16) - 1.8348078631891966e9*pow(x,18) + 1.3036792712133765e9*pow(x,20) - 5.305015216192961e8*pow(x,22) + 9.418324115704894e7*pow(x,24);
    case 26:
        return 108.79667401313782*x - 12620.414185523987*pow(x,3) + 430356.12372636795*pow(x,5) - 6.762739087128639e6*pow(x,7) + 5.917396701237559e7*pow(x,9) - 3.184635315575123e8*pow(x,11) + 1.114622360451293e9*pow(x,13) - 2.6114009587716007e9*pow(x,15) + 4.1283176921756926e9*pow(x,17) - 4.345597570711255e9*pow(x,19) + 2.9177583689061284e9*pow(x,21) - 1.1301988938845873e9*pow(x,23) + 1.9213381196037984e8*pow(x,25);
    case 27:
        return -4.184487462043762 + 1577.5517731904984*pow(x,2) - 97808.2099378109*pow(x,4) + 2.3669586804950237e6*pow(x,6) - 2.9586983506187797e7*pow(x,8) + 2.189436779457897e8*pow(x,10) - 1.0350064775619149e9*pow(x,12) + 3.264251198464501e9*pow(x,14) - 7.018140076698677e9*pow(x,16) + 1.032079423043923e10*pow(x,18) - 1.021215429117145e10*pow(x,20) + 6.498643639836377e9*pow(x,22) - 2.401672649504748e9*pow(x,24) + 3.916573859192358e8*pow(x,26);
    case 28:
        return -121.3501363992691*x + 16301.368322968483*pow(x,3) - 645534.1855895519*pow(x,5) + 1.1834793402475119e7*pow(x,7) - 1.2163537663654983e8*pow(x,9) + 7.762548581714362e8*pow(x,11) - 3.264251198464501e9*pow(x,13) + 9.357520102264902e9*pow(x,15) - 1.8577429614790615e10*pow(x,17) + 2.5530385727928623e10*pow(x,19) - 2.382836001273338e10*pow(x,21) + 1.4410035897028488e10*pow(x,23) - 5.091546016950066e9*pow(x,25) + 7.978206009465915e8*pow(x,27);
    case 29:
        return 4.333933442831039 - 1880.927114188671*pow(x,2) + 134486.28866448998*pow(x,4) - 3.7656160826057196e6*pow(x,6) + 5.473591948644742e7*pow(x,8) - 4.7437796888254434e8*pow(x,10) + 2.652204098752407e9*pow(x,12) - 1.0025914395283825e10*pow(x,14) + 2.6318025287620037e10*pow(x,16) - 4.8507732883064384e10*pow(x,18) + 6.254944503342513e10*pow(x,20) - 5.52384709386092e10*pow(x,22) + 3.1822162605937912e10*pow(x,24) - 1.0770578112778986e10*pow(x,26) + 1.6241347947841327e9*pow(x,28);
    case 30:
        return 134.35193672776222*x - 20690.198256075382*pow(x,3) + 941404.0206514299*pow(x,5) - 1.9903970722344518e7*pow(x,7) + 2.3718898444127217e8*pow(x,9) - 1.7681360658349378e9*pow(x,11) + 8.772675095873346e9*pow(x,13) - 3.007774318585147e10*pow(x,15) + 7.276159932459657e10*pow(x,17) - 1.2509889006685027e11*pow(x,19) + 1.5190579508117532e11*pow(x,21) - 1.2728865042375165e11*pow(x,23) + 7.000875773306342e10*pow(x,25) - 2.273788712697786e10*pow(x,27) + 3.30427423766427e9*pow(x,29);
    case 31:
        return -4.478397890925407 + 2216.8069560080767*pow(x,2) - 181039.2347406596*pow(x,4) + 5.805324794017151e6*pow(x,6) - 9.703185727142952e7*pow(x,8) + 9.724748362092159e8*pow(x,10) - 6.335820902575194e9*pow(x,12) + 2.8197884236735756e10*pow(x,14) - 8.83533706084387e10*pow(x,16) + 1.9807324260584622e11*pow(x,18) - 3.1900216967046814e11*pow(x,20) + 3.65954869968286e11*pow(x,22) - 2.9170315722109753e11*pow(x,24) + 1.5348073810710056e11*pow(x,26) - 4.791197644613191e10*pow(x,28) + 6.718690949917349e9*pow(x,30);
    case 32:
        return -147.78713040053844*x + 25862.747820094228*pow(x,3) - 1.339690337080881e6*pow(x,5) + 3.234395242380984e7*pow(x,7) - 4.420340164587345e8*pow(x,9) + 3.801492541545117e9*pow(x,11) - 2.1931687739683365e10*pow(x,13) + 8.83533706084387e10*pow(x,15) - 2.54665597636088e11*pow(x,17) + 5.3167028278411365e11*pow(x,19) - 8.051007139302291e11*pow(x,21) + 8.751094716632926e11*pow(x,23) - 6.650831984641023e11*pow(x,25) + 3.353838351229234e11*pow(x,27) - 1.0078036424876024e11*pow(x,29) + 1.3654113865961063e10*pow(x,31);
    case 33:
        return 4.618347825016826 - 2586.274782009423*pow(x,2) + 239230.4173358716*pow(x,4) - 8.707987191025726e6*pow(x,6) + 1.657627561720254e8*pow(x,8) - 1.9007462707725585e9*pow(x,10) + 1.4255597030794188e10*pow(x,12) - 7.362780884036559e10*pow(x,14) + 2.705821974883435e11*pow(x,16) - 7.215525266355828e11*pow(x,18) + 1.4089262493779011e12*pow(x,20) - 2.0127517848255728e12*pow(x,22) + 2.0783849952003196e12*pow(x,24) - 1.5092272580531553e12*pow(x,26) + 7.306576408035117e11*pow(x,28) - 2.1163876492239648e11*pow(x,30) + 2.7734918790233414e10*pow(x,32);
    case 34:
        return 161.64217387558892*x - 31897.388978116214*pow(x,3) + 1.8659972552197985e6*pow(x,5) - 5.100392497600783e7*pow(x,7) + 7.919776128218994e8*pow(x,9) - 7.775780198615011e9*pow(x,11) + 5.1539466188255905e10*pow(x,13) - 2.405175088785276e11*pow(x,15) + 8.117465924650306e11*pow(x,17) - 2.0127517848255728e12*pow(x,19) + 3.690044938846884e12*pow(x,21) - 4.988123988480768e12*pow(x,23) + 4.904988588672755e12*pow(x,25) - 3.4097356570830547e12*pow(x,27) + 1.5872907369179736e12*pow(x,29) - 4.4375870064373456e11*pow(x,31) + 5.631028966501935e10*pow(x,33);
    case 35:
        return -4.754181584576145 + 2990.380216698395*pow(x,2) - 310999.5425366331*pow(x,4) + 1.2750981244001957e7*pow(x,6) - 2.741460967460421e8*pow(x,8) + 3.5638992576985464e9*pow(x,10) - 3.045513911124213e10*pow(x,12) + 1.8038813165889566e11*pow(x,14) - 7.666495595503066e11*pow(x,16) + 2.3901427444803677e12*pow(x,18) - 5.535067408270325e12*pow(x,20) + 9.56057097792147e12*pow(x,22) - 1.2262471471681887e13*pow(x,24) + 1.1507857842655309e13*pow(x,26) - 7.671905228436873e12*pow(x,28) + 3.439129929988943e12*pow(x,30) - 9.291197794728192e11*pow(x,32) + 1.1427676432018634e11*pow(x,34);
    case 36:
        return -175.90471862931736*x + 38874.942817079136*pow(x,3) - 2.5501962488003913e6*pow(x,5) + 7.832745621315488e7*pow(x,7) - 1.3707304837302103e9*pow(x,9) + 1.5227569555621063e10*pow(x,11) - 1.1479244741929724e11*pow(x,13) + 6.133196476402454e11*pow(x,15) - 2.3901427444803677e12*pow(x,17) + 6.918834260337906e12*pow(x,19) - 1.5023754393876596e13*pow(x,21) + 2.4524942943363773e13*pow(x,23) - 2.9920430390903805e13*pow(x,25) + 2.6851668299529055e13*pow(x,27) - 1.7195649649944715e13*pow(x,29) + 7.432958235782554e12*pow(x,31) - 1.9427049934431675e12*pow(x,33) + 2.3181857904952084e11*pow(x,35);
    case 37:
        return 4.886242184147704 - 3430.1420132716885*pow(x,2) + 398468.16387506115*pow(x,4) - 1.8276406449736137e7*pow(x,6) + 4.405919411989962e8*pow(x,8) - 6.442433273531989e9*pow(x,10) + 6.217924235211934e10*pow(x,12) - 4.1817248702744e11*pow(x,14) + 2.0316213328083125e12*pow(x,16) - 7.303213941467791e12*pow(x,18) + 1.9718677641963035e13*pow(x,20) - 4.0290977692669055e13*pow(x,22) + 6.233422998104959e13*pow(x,24) - 7.249950440872844e13*pow(x,26) + 6.233422998104959e13*pow(x,28) - 3.84036175515432e13*pow(x,30) + 1.602731619590613e13*pow(x,32) - 4.0568251333666147e12*pow(x,34) + 4.7007656307263947e11*pow(x,36);
    case 38:
        return 190.56344518176047*x - 46878.607514713076*pow(x,3) + 3.426826209325526e6*pow(x,5) - 1.1749118431973231e8*pow(x,7) + 2.3008690262614245e9*pow(x,9) - 2.869811185482431e10*pow(x,11) + 2.4393395076600665e11*pow(x,13) - 1.4775427874969546e12*pow(x,15) + 6.572892547321012e12*pow(x,17) - 2.190964182440337e13*pow(x,19) + 5.540009432741995e13*pow(x,21) - 1.068586799675136e14*pow(x,23) + 1.5708225955224497e14*pow(x,25) - 1.7453584394693884e14*pow(x,27) + 1.4401356581828697e14*pow(x,29) - 8.547901971149938e13*pow(x,31) + 3.4483013633616227e13*pow(x,33) - 8.461378135307511e12*pow(x,35) + 9.528578981202151e11*pow(x,37);
    case 39:
        return -5.01482750478317 + 3906.5506262260897*pow(x,2) - 503945.0307831656*pow(x,4) + 2.5701196569941442e7*pow(x,6) - 6.902607078784274e8*pow(x,8) + 1.1274258228680979e10*pow(x,10) - 1.2196697538300333e11*pow(x,12) + 9.234642421855967e11*pow(x,14) - 5.079053332020781e12*pow(x,16) + 2.0814159733183203e13*pow(x,18) - 6.4633443381989945e13*pow(x,20) + 1.5360935245330078e14*pow(x,22) - 2.8050403491472316e14*pow(x,24) + 3.9270564888061244e14*pow(x,26) - 4.1763934087303225e14*pow(x,28) + 3.3123120138206006e14*pow(x,30) - 1.8965657498488922e14*pow(x,32) + 7.403705868394072e13*pow(x,34) - 1.762787111522398e13*pow(x,36) + 1.930791004085699e12*pow(x,38);
    case 40:
        return -205.60792769610998*x + 55993.89230924062*pow(x,3) - 4.53550527704849e6*pow(x,5) + 1.7256517696960685e8*pow(x,7) - 3.758086076226993e9*pow(x,9) + 5.227156087843e10*pow(x,11) - 4.9724997656147516e11*pow(x,13) + 3.386035554680521e12*pow(x,15) - 1.7029767054422621e13*pow(x,17) + 6.463344338198994e13*pow(x,19) - 1.8774476410958984e14*pow(x,21) + 4.2075605237208475e14*pow(x,23) - 7.293104907782802e14*pow(x,25) + 9.744917953704086e14*pow(x,27) - 9.936936041461802e14*pow(x,29) + 7.586262999395569e14*pow(x,31) - 4.1954333254233075e14*pow(x,33) + 1.586508400370158e14*pow(x,35) - 3.668502907762828e13*pow(x,37) + 3.9110894698146216e12*pow(x,39);
    default:
        AssertMsg(false, "Could not find moment");
        break;
    }
}
    
double dd_legendre_polynomial(int l,
                              double const &x)
{
    switch(l)
    {
    case 0:
        return 0;
    case 1:
        return 0;
    case 2:
        return 3.;
    case 3:
        return 15.*x;
    case 4:
        return -7.5 + 52.5*pow(x,2);
    case 5:
        return -52.5*x + 157.5*pow(x,3);
    case 6:
        return 13.125 - 236.25*pow(x,2) + 433.125*pow(x,4);
    case 7:
        return 118.125*x - 866.25*pow(x,3) + 1126.125*pow(x,5);
    case 8:
        return -19.6875 + 649.6875*pow(x,2) - 2815.3125*pow(x,4) + 2815.3125*pow(x,6);
    case 9:
        return -216.5625*x + 2815.3125*pow(x,3) - 8445.9375*pow(x,5) + 6837.1875*pow(x,7);
    case 10:
        return 27.0703125 - 1407.65625*pow(x,2) + 10557.421875*pow(x,4) - 23930.15625*pow(x,6) + 16238.3203125*pow(x,8);
    case 11:
        return 351.9140625*x - 7038.28125*pow(x,3) + 35895.234375*pow(x,5) - 64953.28125*pow(x,7) + 37889.4140625*pow(x,9);
    case 12:
        return -35.19140625 + 2639.35546875*pow(x,2) - 29912.6953125*pow(x,4) + 113668.2421875*pow(x,6) - 170502.36328125*pow(x,8) + 87145.65234375*pow(x,10);
    case 13:
        return -527.87109375*x + 14956.34765625*pow(x,3) - 113668.2421875*pow(x,5) + 341004.7265625*pow(x,7) - 435728.26171875*pow(x,9) + 198058.30078125*pow(x,11);
    case 14:
        return 43.9892578125 - 4486.904296875*pow(x,2) + 71042.6513671875*pow(x,4) - 397838.84765625*pow(x,6) + 980388.5888671875*pow(x,8) - 1.089320654296875e6*pow(x,10) + 445631.1767578125*pow(x,12);
    case 15:
        return 747.8173828125*x - 28417.060546875*pow(x,3) + 298379.1357421875*pow(x,5) - 1.30718478515625e6*pow(x,7) + 2.7233016357421875e6*pow(x,9) - 2.673787060546875e6*pow(x,11) + 994100.3173828125*pow(x,13);
    case 16:
        return -53.41552734375 + 7104.26513671875*pow(x,2) - 149189.56787109375*pow(x,4) + 1.1437866870117188e6*pow(x,6) - 4.0849524536132812e6*pow(x,8) + 7.352914416503906e6*pow(x,10) - 6.461652062988281e6*pow(x,12) + 2.2012221313476562e6*pow(x,14);
    case 17:
        return -1014.89501953125*x + 49729.85595703125*pow(x,3) - 686272.0122070312*pow(x,5) + 4.0849524536132812e6*pow(x,7) - 1.2254857360839844e7*pow(x,9) + 1.9384956188964844e7*pow(x,11) - 1.5408554919433594e7*pow(x,13) + 4.842688688964844e6*pow(x,15);
    case 18:
        return 63.430938720703125 - 10656.397705078125*pow(x,2) + 285946.6717529297*pow(x,4) - 2.859466717529297e6*pow(x,6) + 1.3786714530944824e7*pow(x,8) - 3.553908634643555e7*pow(x,10) + 5.007780348815918e7*pow(x,12) - 3.632016516723633e7*pow(x,14) + 1.0593381507110596e7*pow(x,16);
    case 19:
        return 1332.0497131347656*x - 81699.04907226562*pow(x,3) + 1.4297333587646484e6*pow(x,5) - 1.102937162475586e7*pow(x,7) + 4.442385793304443e7*pow(x,9) - 1.0015560697631836e8*pow(x,11) + 1.2712057808532715e8*pow(x,13) - 8.474705205688477e7*pow(x,15) + 2.3056183280181885e7*pow(x,17);
    case 20:
        return -74.00276184082031 + 15318.571701049805*pow(x,2) - 510619.05670166016*pow(x,4) + 6.433800114440918e6*pow(x,6) - 3.998147213973999e7*pow(x,8) + 1.3771395959243774e8*pow(x,10) - 2.754279191848755e8*pow(x,12) + 3.178014452133179e8*pow(x,14) - 1.9597755788154602e8*pow(x,16) + 4.995506377372742e7*pow(x,18);
    case 21:
        return -1702.0635223388672*x + 127654.76417541504*pow(x,3) - 2.757342906188965e6*pow(x,5) + 2.665431475982666e7*pow(x,7) - 1.3771395959243774e8*pow(x,9) + 4.1314187877731323e8*pow(x,11) - 7.415367054977417e8*pow(x,13) + 7.839102315261841e8*pow(x,15) - 4.4959557396354675e8*pow(x,17) + 1.0779776919593811e8*pow(x,19);
    case 22:
        return 85.10317611694336 - 21275.79402923584*pow(x,2) + 861669.6581840515*pow(x,4) - 1.332715737991333e7*pow(x,6) + 1.0328546969432831e8*pow(x,8) - 4.5445606665504456e8*pow(x,10) + 1.2049971464338303e9*pow(x,12) - 1.9597755788154602e9*pow(x,14) + 1.9107811893450737e9*pow(x,16) - 1.024078807361412e9*pow(x,18) + 2.3176520377126694e8*pow(x,20);
    case 23:
        return 2127.579402923584*x - 191482.14626312256*pow(x,3) + 4.997684017467499e6*pow(x,5) - 5.902026839675903e7*pow(x,7) + 3.787133888792038e8*pow(x,9) - 1.4459965757205963e9*pow(x,11) + 3.4296072629270554e9*pow(x,13) - 5.095416504920197e9*pow(x,15) + 4.608354633126354e9*pow(x,17) - 2.3176520377126694e9*pow(x,19) + 4.966397223670006e8*pow(x,21);
    case 24:
        return -96.70815467834473 + 28722.321939468384*pow(x,2) - 1.3882455604076385e6*pow(x,4) + 2.5821367423582077e7*pow(x,6) - 2.43458607136631e8*pow(x,8) + 1.3254968610772133e9*pow(x,10) - 4.458489441805172e9*pow(x,12) + 9.553905946725368e9*pow(x,14) - 1.3057004793858004e10*pow(x,16) + 1.100884717913518e10*pow(x,18) - 5.214717084853506e9*pow(x,20) + 1.0610030432385921e9*pow(x,22);
    case 25:
        return -2611.1201763153076*x + 277649.1120815277*pow(x,3) - 8.607122474527359e6*pow(x,5) + 1.217293035683155e8*pow(x,7) - 9.467834721980095e8*pow(x,9) + 4.458489441805172e9*pow(x,11) - 1.3375468325415516e10*pow(x,13) + 2.6114009587716007e10*pow(x,15) - 3.302654153740554e10*pow(x,17) + 2.6073585424267532e10*pow(x,19) - 1.1671033475624514e10*pow(x,21) + 2.2603977877691746e9*pow(x,23);
    case 26:
        return 108.79667401313782 - 37861.24255657196*pow(x,2) + 2.1517806186318398e6*pow(x,4) - 4.7339173609900475e7*pow(x,6) + 5.3256570311138034e8*pow(x,8) - 3.503098847132635e9*pow(x,10) + 1.449009068586681e10*pow(x,12) - 3.917101438157401e10*pow(x,14) + 7.018140076698677e10*pow(x,16) - 8.256635384351384e10*pow(x,18) + 6.1272925747028694e10*pow(x,20) - 2.599457455934551e10*pow(x,22) + 4.803345299009496e9*pow(x,24);
    case 27:
        return 3155.1035463809967*x - 391232.8397512436*pow(x,3) + 1.4201752082970142e7*pow(x,5) - 2.3669586804950237e8*pow(x,7) + 2.189436779457897e9*pow(x,9) - 1.242007773074298e10*pow(x,11) + 4.569951677850301e10*pow(x,13) - 1.1229024122717883e11*pow(x,15) + 1.8577429614790613e11*pow(x,17) - 2.04243085823429e11*pow(x,19) + 1.429701600764003e11*pow(x,21) - 5.764014358811395e10*pow(x,23) + 1.0183092033900131e10*pow(x,25);
    case 28:
        return -121.3501363992691 + 48904.10496890545*pow(x,2) - 3.2276709279477596e6*pow(x,4) + 8.284355381732583e7*pow(x,6) - 1.0947183897289486e9*pow(x,8) + 8.538803439885798e9*pow(x,10) - 4.243526558003851e10*pow(x,12) + 1.4036280153397354e11*pow(x,14) - 3.158163034514404e11*pow(x,16) + 4.8507732883064386e11*pow(x,18) - 5.0039556026740094e11*pow(x,20) + 3.314308256316552e11*pow(x,22) - 1.2728865042375165e11*pow(x,24) + 2.1541156225557972e10*pow(x,26);
    case 29:
        return -3761.854228377342*x + 537945.1546579599*pow(x,3) - 2.2593696495634317e7*pow(x,5) + 4.378873558915794e8*pow(x,7) - 4.743779688825443e9*pow(x,9) + 3.1826449185028885e10*pow(x,11) - 1.4036280153397354e11*pow(x,13) + 4.210884046019206e11*pow(x,15) - 8.731391918951589e11*pow(x,17) + 1.2509889006685027e12*pow(x,19) - 1.2152463606494023e12*pow(x,21) + 7.637319025425099e11*pow(x,23) - 2.8003503093225366e11*pow(x,25) + 4.547577425395572e10*pow(x,27);
    case 30:
        return 134.35193672776222 - 62070.59476822615*pow(x,2) + 4.707020103257149e6*pow(x,4) - 1.3932779505641162e8*pow(x,6) + 2.1347008599714496e9*pow(x,8) - 1.9449496724184315e10*pow(x,10) + 1.140447762463535e11*pow(x,12) - 4.511661477877721e11*pow(x,14) + 1.2369471885181418e12*pow(x,16) - 2.3768789112701553e12*pow(x,18) + 3.1900216967046816e12*pow(x,20) - 2.927638959746288e12*pow(x,22) + 1.7502189433265854e12*pow(x,24) - 6.139229524284022e11*pow(x,26) + 9.582395289226382e10*pow(x,28);
    case 31:
        return 4433.613912016153*x - 724156.9389626384*pow(x,3) + 3.4831948764102906e7*pow(x,5) - 7.762548581714362e8*pow(x,7) + 9.72474836209216e9*pow(x,9) - 7.602985083090233e10*pow(x,11) + 3.947703793143006e11*pow(x,13) - 1.4136539297350193e12*pow(x,15) + 3.565318366905232e12*pow(x,17) - 6.380043393409363e12*pow(x,19) + 8.051007139302292e12*pow(x,21) - 7.000875773306341e12*pow(x,23) + 3.9904991907846143e12*pow(x,25) - 1.3415353404916936e12*pow(x,27) + 2.0156072849752048e11*pow(x,29);
    case 32:
        return -147.78713040053844 + 77588.24346028268*pow(x,2) - 6.698451685404405e6*pow(x,4) + 2.264076669666689e8*pow(x,6) - 3.9783061481286106e9*pow(x,8) + 4.1816417956996284e10*pow(x,10) - 2.851119406158837e11*pow(x,12) + 1.3253005591265806e12*pow(x,14) - 4.329315159813496e12*pow(x,16) + 1.010173537289816e13*pow(x,18) - 1.6907114992534812e13*pow(x,20) + 2.012751784825573e13*pow(x,22) - 1.6627079961602557e13*pow(x,24) + 9.055363548318932e12*pow(x,26) - 2.922630563214047e12*pow(x,28) + 4.2327752984479297e11*pow(x,30);
    case 33:
        return -5172.549564018846*x + 956921.6693434864*pow(x,3) - 5.224792314615436e7*pow(x,5) + 1.3261020493762033e9*pow(x,7) - 1.9007462707725586e10*pow(x,9) + 1.7106716436953024e11*pow(x,11) - 1.0307893237651182e12*pow(x,13) + 4.329315159813496e12*pow(x,15) - 1.298794547944049e13*pow(x,17) + 2.8178524987558023e13*pow(x,19) - 4.42805392661626e13*pow(x,21) + 4.988123988480767e13*pow(x,23) - 3.923990870938204e13*pow(x,25) + 2.045841394249833e13*pow(x,27) - 6.349162947671895e12*pow(x,29) + 8.875174012874692e11*pow(x,31);
    case 34:
        return 161.64217387558892 - 95692.16693434864*pow(x,2) + 9.329986276098993e6*pow(x,4) - 3.570274748320548e8*pow(x,6) + 7.127798515397095e9*pow(x,8) - 8.553358218476512e10*pow(x,10) + 6.700130604473268e11*pow(x,12) - 3.607762633177914e12*pow(x,14) + 1.3799692071905521e13*pow(x,16) - 3.824228391168588e13*pow(x,18) + 7.749094371578456e13*pow(x,20) - 1.1472685173505766e14*pow(x,22) + 1.2262471471681888e14*pow(x,24) - 9.206286274124247e13*pow(x,26) + 4.6031431370621234e13*pow(x,28) - 1.3756519719955771e13*pow(x,30) + 1.8582395589456384e12*pow(x,32);
    case 35:
        return 5980.76043339679*x - 1.2439981701465324e6*pow(x,3) + 7.650588746401174e7*pow(x,5) - 2.1931687739683366e9*pow(x,7) + 3.5638992576985466e10*pow(x,9) - 3.654616693349056e11*pow(x,11) + 2.525433843224539e12*pow(x,13) - 1.2266392952804906e13*pow(x,15) + 4.302256940064662e13*pow(x,17) - 1.107013481654065e14*pow(x,19) + 2.1033256151427234e14*pow(x,21) - 2.9429931532036525e14*pow(x,23) + 2.99204303909038e14*pow(x,25) - 2.1481334639623244e14*pow(x,27) + 1.0317389789966828e14*pow(x,29) - 2.9731832943130215e13*pow(x,31) + 3.8854099868863354e12*pow(x,33);
    case 36:
        return -175.90471862931736 + 116624.82845123741*pow(x,2) - 1.2750981244001957e7*pow(x,4) + 5.482921934920841e8*pow(x,6) - 1.2336574353571892e10*pow(x,8) + 1.675032651118317e11*pow(x,10) - 1.4923018164508643e12*pow(x,12) + 9.19979471460368e12*pow(x,14) - 4.063242665616625e13*pow(x,16) + 1.3145785094642022e14*pow(x,18) - 3.154988422714085e14*pow(x,20) + 5.640736876973668e14*pow(x,22) - 7.480107597725951e14*pow(x,24) + 7.249950440872845e14*pow(x,26) - 4.9867383984839675e14*pow(x,28) + 2.3042170530925916e14*pow(x,30) - 6.410926478362452e13*pow(x,32) + 8.1136502667332295e12*pow(x,34);
    case 37:
        return -6860.284026543377*x + 1.5938726555002446e6*pow(x,3) - 1.0965843869841683e8*pow(x,5) + 3.5247355295919695e9*pow(x,7) - 6.442433273531989e10*pow(x,9) + 7.461509082254321e11*pow(x,11) - 5.85441481838416e12*pow(x,13) + 3.2505941324933e13*pow(x,15) - 1.3145785094642023e14*pow(x,17) + 3.943735528392607e14*pow(x,19) - 8.864015092387192e14*pow(x,21) + 1.4960215195451902e15*pow(x,23) - 1.8849871146269395e15*pow(x,25) + 1.7453584394693885e15*pow(x,27) - 1.152108526546296e15*pow(x,29) + 5.128741182689962e14*pow(x,31) - 1.379320545344649e14*pow(x,33) + 1.6922756270615021e13*pow(x,35);
    case 38:
        return 190.56344518176047 - 140635.82254413923*pow(x,2) + 1.713413104662763e7*pow(x,4) - 8.224382902381262e8*pow(x,6) + 2.070782123635282e10*pow(x,8) - 3.156792304030674e11*pow(x,10) + 3.1711413599580864e12*pow(x,12) - 2.216314181245432e13*pow(x,14) + 1.117391733044572e14*pow(x,16) - 4.1628319466366406e14*pow(x,18) + 1.163401980875819e15*pow(x,20) - 2.4577496392528125e15*pow(x,22) + 3.927056488806124e15*pow(x,24) - 4.712467786567349e15*pow(x,26) + 4.176393408730322e15*pow(x,28) - 2.6498496110564805e15*pow(x,30) + 1.1379394499093355e15*pow(x,32) - 2.961482347357629e14*pow(x,34) + 3.525574223044796e13*pow(x,36);
    case 39:
        return 7813.101252452179*x - 2.0157801231326624e6*pow(x,3) + 1.5420717941964865e8*pow(x,5) - 5.522085663027419e9*pow(x,7) + 1.1274258228680978e11*pow(x,9) - 1.46360370459604e12*pow(x,11) + 1.2928499390598354e13*pow(x,13) - 8.12648533123325e13*pow(x,15) + 3.746548751972976e14*pow(x,17) - 1.292668867639799e15*pow(x,19) + 3.379405753972617e15*pow(x,21) - 6.732096837953356e15*pow(x,23) + 1.0210346870895924e16*pow(x,25) - 1.1693901544444904e16*pow(x,27) + 9.936936041461802e15*pow(x,29) - 6.069010399516455e15*pow(x,31) + 2.5172599952539845e15*pow(x,33) - 6.346033601480632e14*pow(x,35) + 7.337005815525656e13*pow(x,37);
    case 40:
        return -205.60792769610998 + 167981.67692772186*pow(x,2) - 2.267752638524245e7*pow(x,4) + 1.207956238787248e9*pow(x,6) - 3.382277468604294e10*pow(x,8) + 5.7498716966273e11*pow(x,10) - 6.464249695299177e12*pow(x,12) + 5.079053332020781e13*pow(x,14) - 2.8950603992518456e14*pow(x,16) + 1.2280354242578088e15*pow(x,18) - 3.9426400463013865e15*pow(x,20) + 9.67738920455795e15*pow(x,22) - 1.823276226945701e16*pow(x,24) + 2.631127847500103e16*pow(x,26) - 2.8817114520239228e16*pow(x,28) + 2.3517415298126264e16*pow(x,30) - 1.3844929973896914e16*pow(x,32) + 5.552779401295553e15*pow(x,34) - 1.3573460758722465e15*pow(x,36) + 1.5253248932277025e14*pow(x,38);
    default:
        AssertMsg(false, "Could not find moment");
        break;
    }
}
} // namespace Math_Functions
